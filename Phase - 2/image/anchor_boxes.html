<!DOCTYPE html><html xmlns:cc="http://creativecommons.org/ns#"><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# medium-com: http://ogp.me/ns/fb/medium-com#"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=contain"><title>Real-time Object Detection with YOLO, YOLOv2 and now YOLOv3</title><link rel="canonical" href="https://medium.com/@jonathan_hui/real-time-object-detection-with-yolo-yolov2-28b1b93e2088"><meta name="title" content="Real-time Object Detection with YOLO, YOLOv2 and now YOLOv3"><meta name="referrer" content="unsafe-url"><meta name="description" content="You only look once (YOLO) is an object detection system targeted for real-time processing. We will introduce YOLO, YOLOv2 and YOLO9000 in this article. For those only interested in YOLOv3, please…"><meta name="theme-color" content="#000000"><meta property="og:title" content="Real-time Object Detection with YOLO, YOLOv2 and now YOLOv3"><meta property="twitter:title" content="Real-time Object Detection with YOLO, YOLOv2 and now YOLOv3"><meta property="og:url" content="https://medium.com/@jonathan_hui/real-time-object-detection-with-yolo-yolov2-28b1b93e2088"><meta property="og:image" content="https://cdn-images-1.medium.com/max/1200/1*j4PnWfxP3yoVPOFyI27tww.jpeg"><meta property="fb:app_id" content="542599432471018"><meta property="og:description" content="You only look once (YOLO) is an object detection system targeted for real-time processing. We will introduce YOLO, YOLOv2 and YOLO9000 in…"><meta name="twitter:description" content="You only look once (YOLO) is an object detection system targeted for real-time processing. We will introduce YOLO, YOLOv2 and YOLO9000 in…"><meta name="twitter:image:src" content="https://cdn-images-1.medium.com/max/1200/1*j4PnWfxP3yoVPOFyI27tww.jpeg"><link rel="publisher" href="https://plus.google.com/103654360130207659246"><link rel="author" href="https://medium.com/@jonathan_hui"><meta property="author" content="Jonathan Hui"><meta property="og:type" content="article"><meta name="twitter:card" content="summary_large_image"><meta property="article:publisher" content="https://www.facebook.com/medium"><meta property="article:author" content="https://medium.com/@jonathan_hui"><meta name="robots" content="index, follow"><meta property="article:published_time" content="2018-03-18T02:08:01.687Z"><meta name="twitter:site" content="@Medium"><meta property="og:site_name" content="Medium"><meta name="twitter:label1" value="Reading time"><meta name="twitter:data1" value="18 min read"><meta name="twitter:app:name:iphone" content="Medium"><meta name="twitter:app:id:iphone" content="828256236"><meta name="twitter:app:url:iphone" content="medium://p/28b1b93e2088"><meta property="al:ios:app_name" content="Medium"><meta property="al:ios:app_store_id" content="828256236"><meta property="al:android:package" content="com.medium.reader"><meta property="al:android:app_name" content="Medium"><meta property="al:ios:url" content="medium://p/28b1b93e2088"><meta property="al:android:url" content="medium://p/28b1b93e2088"><meta property="al:web:url" content="https://medium.com/@jonathan_hui/real-time-object-detection-with-yolo-yolov2-28b1b93e2088"><link rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml" /><link rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/28b1b93e2088" /><script type="application/ld+json">{"@context":"http://schema.org","@type":"NewsArticle","image":{"@type":"ImageObject","width":1920,"height":1173,"url":"https://cdn-images-1.medium.com/max/2600/1*j4PnWfxP3yoVPOFyI27tww.jpeg"},"url":"https://medium.com/@jonathan_hui/real-time-object-detection-with-yolo-yolov2-28b1b93e2088","dateCreated":"2018-03-18T02:08:01.687Z","datePublished":"2018-03-18T02:08:01.687Z","dateModified":"2019-03-27T20:41:17.642Z","headline":"Real-time Object Detection with YOLO, YOLOv2 and now YOLOv3","name":"Real-time Object Detection with YOLO, YOLOv2 and now YOLOv3","articleId":"28b1b93e2088","thumbnailUrl":"https://cdn-images-1.medium.com/max/2600/1*j4PnWfxP3yoVPOFyI27tww.jpeg","keywords":["Tag:Machine Learning","Tag:Deep Learning","Tag:Computer Vision","Tag:Artificial Intelligence","LockedPostSource:0","Elevated:false","LayerCake:0"],"author":{"@type":"Person","name":"Jonathan Hui","url":"https://medium.com/@jonathan_hui"},"creator":["Jonathan Hui"],"publisher":{"@type":"Organization","name":"Medium","url":"https://medium.com/","logo":{"@type":"ImageObject","width":308,"height":60,"url":"https://cdn-images-1.medium.com/max/462/1*OMF3fSqH8t4xBJ9-6oZDZw.png"}},"mainEntityOfPage":"https://medium.com/@jonathan_hui/real-time-object-detection-with-yolo-yolov2-28b1b93e2088"}</script><meta name="parsely-link" content="https://medium.com/@jonathan_hui/real-time-object-detection-with-yolo-yolov2-28b1b93e2088"><link rel="stylesheet" type="text/css" class="js-glyph-" id="glyph-8" href="https://glyph.medium.com/css/e/sr/latin/e/ssr/latin/e/ssb/latin/m2.css" /><link rel="stylesheet" href="https://cdn-static-1.medium.com/_/fp/css/main-branding-base.K9x5KNpUO_SF5T-7n5NSug.css"><script>!function(n,e){var t,o,i,c=[],f={passive:!0,capture:!0},r=new Date,a="pointerup",u="pointercancel";function p(n,c){t||(t=c,o=n,i=new Date,w(e),s())}function s(){o>=0&&o<i-r&&(c.forEach(function(n){n(o,t)}),c=[])}function l(t){if(t.cancelable){var o=(t.timeStamp>1e12?new Date:performance.now())-t.timeStamp;"pointerdown"==t.type?function(t,o){function i(){p(t,o),r()}function c(){r()}function r(){e(a,i,f),e(u,c,f)}n(a,i,f),n(u,c,f)}(o,t):p(o,t)}}function w(n){["click","mousedown","keydown","touchstart","pointerdown"].forEach(function(e){n(e,l,f)})}w(n),self.perfMetrics=self.perfMetrics||{},self.perfMetrics.onFirstInputDelay=function(n){c.push(n),s()}}(addEventListener,removeEventListener);</script><script>if (window.top !== window.self) window.top.location = window.self.location.href;var OB_startTime = new Date().getTime(); var OB_loadErrors = []; function _onerror(e) { OB_loadErrors.push(e) }; if (document.addEventListener) document.addEventListener("error", _onerror, true); else if (document.attachEvent) document.attachEvent("onerror", _onerror); function _asyncScript(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("script"); s.type = "text/javascript"; s.async = true; s.src = u; f.parentNode.insertBefore(s, f);}function _asyncStyles(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("link"); s.rel = "stylesheet"; s.href = u; f.parentNode.insertBefore(s, f); return s}(new Image()).src = "/_/stat?event=pixel.load&origin=" + encodeURIComponent(location.origin);</script><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date; ga("create", "UA-24232453-2", "auto", {"allowLinker": true, "legacyCookieDomain": window.location.hostname}); ga("send", "pageview");</script><script async src="https://www.google-analytics.com/analytics.js"></script><!--[if lt IE 9]><script charset="UTF-8" src="https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js"></script><![endif]--><link rel="icon" href="https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico" class="js-favicon"><link rel="apple-touch-icon" sizes="152x152" href="https://cdn-images-1.medium.com/fit/c/228/228/1*8I-HPL0bfoIzGied-dzOvA.png"><link rel="apple-touch-icon" sizes="120x120" href="https://cdn-images-1.medium.com/fit/c/180/180/1*8I-HPL0bfoIzGied-dzOvA.png"><link rel="apple-touch-icon" sizes="76x76" href="https://cdn-images-1.medium.com/fit/c/114/114/1*8I-HPL0bfoIzGied-dzOvA.png"><link rel="apple-touch-icon" sizes="60x60" href="https://cdn-images-1.medium.com/fit/c/90/90/1*8I-HPL0bfoIzGied-dzOvA.png"><link rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg" color="#171717"></head><body itemscope class=" postShowScreen browser-chrome os-windows is-withMagicUnderlines v-glyph v-glyph--m2 is-noJs"><script>document.body.className = document.body.className.replace(/(^|\s)is-noJs(\s|$)/, "$1is-js$2")</script><div class="site-main" id="container"><div class="butterBar butterBar--error"></div><div class="surface"><div id="prerendered" class="screenContent"><canvas class="canvas-renderer"></canvas><div class="container u-maxWidth740 u-xs-margin0 notesPositionContainer js-notesPositionContainer"></div><div class="metabar u-clearfix u-boxShadow4px12pxBlackLightest js-metabar"><div class="branch-journeys-top"></div><div class="js-metabarMiddle metabar-inner u-marginAuto u-maxWidth1032 u-flexCenter u-justifyContentSpaceBetween u-height65 u-xs-height56 u-paddingHorizontal20"><div class="metabar-block u-flex1 u-flexCenter"><div class="u-xs-hide js-metabarLogoLeft"><a href="https://medium.com/" data-log-event="home" class="siteNav-logo u-fillTransparentBlackDarker u-flex0 u-flexCenter u-paddingTop0"><span class="svgIcon svgIcon--logoMonogram svgIcon--45px is-flushLeft u-flex0 u-flexCenter u-paddingTop0"><svg class="svgIcon-use" width="45" height="45" ><path d="M5 40V5h35v35H5zm8.56-12.627c0 .555-.027.687-.318 1.03l-2.457 2.985v.396h6.974v-.396l-2.456-2.985c-.291-.343-.344-.502-.344-1.03V18.42l6.127 13.364h.714l5.256-13.364v10.644c0 .29 0 .342-.185.528l-1.848 1.796v.396h9.19v-.396l-1.822-1.796c-.184-.186-.21-.238-.21-.528V15.937c0-.291.026-.344.21-.528l1.823-1.797v-.396h-6.471l-4.622 11.542-5.203-11.542h-6.79v.396l2.14 2.64c.239.292.291.37.291.768v10.353z"/></svg></span><span class="u-textScreenReader">Homepage</span></a></div><div class="u-xs-show js-metabarLogoLeft"><a href="https://medium.com/" data-log-event="home" class="siteNav-logo u-fillTransparentBlackDarker u-flex0 u-flexCenter u-paddingTop0"><span class="svgIcon svgIcon--logoMonogram svgIcon--45px is-flushLeft u-flex0 u-flexCenter u-paddingTop0"><svg class="svgIcon-use" width="45" height="45" ><path d="M5 40V5h35v35H5zm8.56-12.627c0 .555-.027.687-.318 1.03l-2.457 2.985v.396h6.974v-.396l-2.456-2.985c-.291-.343-.344-.502-.344-1.03V18.42l6.127 13.364h.714l5.256-13.364v10.644c0 .29 0 .342-.185.528l-1.848 1.796v.396h9.19v-.396l-1.822-1.796c-.184-.186-.21-.238-.21-.528V15.937c0-.291.026-.344.21-.528l1.823-1.797v-.396h-6.471l-4.622 11.542-5.203-11.542h-6.79v.396l2.14 2.64c.239.292.291.37.291.768v10.353z"/></svg></span><span class="u-textScreenReader">Homepage</span></a></div></div><div class="metabar-block u-flex0"><div class="buttonSet buttonSet--wide"><label class="button button--small button--chromeless button--withIcon button--withSvgIcon inputGroup u-sm-hide metabar-predictiveSearch u-baseColor--buttonNormal u-baseColor--placeholderNormal" title="Search Medium"><span class="svgIcon svgIcon--search svgIcon--25px u-baseColor--iconLight"><svg class="svgIcon-use" width="25" height="25" ><path d="M20.067 18.933l-4.157-4.157a6 6 0 1 0-.884.884l4.157 4.157a.624.624 0 1 0 .884-.884zM6.5 11c0-2.62 2.13-4.75 4.75-4.75S16 8.38 16 11s-2.13 4.75-4.75 4.75S6.5 13.62 6.5 11z"/></svg></span><input class="js-predictiveSearchInput textInput textInput--rounded textInput--darkText u-baseColor--textNormal textInput--transparent" type="search" placeholder="Search Medium" required="true" /></label><a class="button button--small button--chromeless u-sm-show is-inSiteNavBar u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--chromeless u-xs-top1"   href="https://medium.com/search" title="Search" aria-label="Search"><span class="button-defaultState"><span class="svgIcon svgIcon--search svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" ><path d="M20.067 18.933l-4.157-4.157a6 6 0 1 0-.884.884l4.157 4.157a.624.624 0 1 0 .884-.884zM6.5 11c0-2.62 2.13-4.75 4.75-4.75S16 8.38 16 11s-2.13 4.75-4.75 4.75S6.5 13.62 6.5 11z"/></svg></span></span></a><button class="button button--small button--chromeless is-inSiteNavBar u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--activity js-notificationsButton u-marginRight16 u-xs-marginRight10 u-lineHeight0 u-size25x25"  title="Notifications" aria-label="Notifications" data-action="open-notifications"><span class="svgIcon svgIcon--bell svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"  viewBox="-293 409 25 25"><path d="M-273.327 423.67l-1.673-1.52v-3.646a5.5 5.5 0 0 0-6.04-5.474c-2.86.273-4.96 2.838-4.96 5.71v3.41l-1.68 1.553c-.204.19-.32.456-.32.734V427a1 1 0 0 0 1 1h3.49a3.079 3.079 0 0 0 3.01 2.45 3.08 3.08 0 0 0 3.01-2.45h3.49a1 1 0 0 0 1-1v-2.59c0-.28-.12-.55-.327-.74zm-7.173 5.63c-.842 0-1.55-.546-1.812-1.3h3.624a1.92 1.92 0 0 1-1.812 1.3zm6.35-2.45h-12.7v-2.347l1.63-1.51c.236-.216.37-.522.37-.843v-3.41c0-2.35 1.72-4.356 3.92-4.565a4.353 4.353 0 0 1 4.78 4.33v3.645c0 .324.137.633.376.85l1.624 1.477v2.373z"/></svg></span></button><a class="button button--small button--upsellNav button--withChrome u-baseColor--buttonNormal u-xs-hide js-upgradeMembershipAction"   href="https://medium.com/membership?source=upgrade_membership---nav_full" data-disable-client-nav="true">Upgrade</a><button class="button button--chromeless u-baseColor--buttonNormal is-inSiteNavBar js-userActions"  aria-haspopup="true" data-action="open-userActions"><div class="avatar"><img  src="https://cdn-images-1.medium.com/fit/c/48/48/0*Vn6DLUxkc4s-ryDf." class="avatar-image avatar-image--icon" alt="UTKARSH VARDHAN"></div></button></div></div></div></div><div class="metabar metabar--spacer js-metabarSpacer u-height65 u-xs-height56"></div><main role="main"><article class=" u-minHeight100vhOffset65 u-overflowHidden postArticle postArticle--full"  lang="en"><div class="postArticle-content js-postField js-notesSource js-trackPostScrolls"  data-post-id="28b1b93e2088" data-source="post_page" data-tracking-context="postPage"><section name="b001" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h1 name="79c8" id="79c8" class="graf graf--h3 graf--leading graf--title">Real-time Object Detection with YOLO, YOLOv2 and now YOLOv3</h1><div class="uiScale uiScale-ui--regular uiScale-caption--regular u-flexCenter u-marginVertical24 u-fontSize15 js-postMetaLockup"><div class="u-flex0"><a class="link u-baseColor--link avatar"   href="https://medium.com/@jonathan_hui?source=post_header_lockup" data-action="show-user-card" data-action-source="post_header_lockup" data-action-value="bd51f1a63813" data-action-type="hover" data-user-id="bd51f1a63813" dir="auto"><img  src="https://cdn-images-1.medium.com/fit/c/75/75/1*c3Z3aOPBooxEX4tx4RkzLw.jpeg" class="avatar-image u-size50x50" alt="Go to the profile of Jonathan Hui"></a></div><div class="u-flex1 u-paddingLeft15 u-overflowHidden"><div class="u-paddingBottom3"><a class="ds-link ds-link--styleSubtle ui-captionStrong u-inlineBlock link link--darken link--darker"   href="https://medium.com/@jonathan_hui" data-action="show-user-card" data-action-value="bd51f1a63813" data-action-type="hover" data-user-id="bd51f1a63813" dir="auto">Jonathan Hui</a></div><div class="ui-caption u-noWrapWithEllipsis js-testPostMetaInlineSupplemental"><time datetime="2018-03-18T02:08:01.687Z">Mar 18, 2018</time><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="18 min read"></span></div></div></div><p name="1749" id="1749" class="graf graf--p graf-after--h3"><strong class="markup--strong markup--p-strong">You only look once (YOLO)</strong> is an object detection system targeted for real-time processing. We will introduce YOLO, YOLOv2 and YOLO9000 in this article. For those only interested in YOLOv3, please forward to the<a href="https://medium.com/@jonathan_hui/real-time-object-detection-with-yolo-yolov2-28b1b93e2088#b8ad" data-href="https://medium.com/@jonathan_hui/real-time-object-detection-with-yolo-yolov2-28b1b93e2088#b8ad" class="markup--anchor markup--p-anchor"> bottom of the article</a>. Here is the accuracy and speed comparison provided by the YOLO web site.</p><figure name="86c5" id="86c5" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 616px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 88%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*ju1oaoIkVUkaIPAdpehlzA.png" data-width="1091" data-height="960" data-action="zoom" data-action-value="1*ju1oaoIkVUkaIPAdpehlzA.png"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*ju1oaoIkVUkaIPAdpehlzA.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*ju1oaoIkVUkaIPAdpehlzA.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*ju1oaoIkVUkaIPAdpehlzA.png"></noscript></div></div><figcaption class="imageCaption"><a href="https://pjreddie.com/darknet/yolo/" data-href="https://pjreddie.com/darknet/yolo/" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">Source</a></figcaption></figure><p name="e01c" id="e01c" class="graf graf--p graf-after--figure">A demonstration from the YOLOv2.</p><figure name="da74" id="da74" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 56.2%;"></div><div class="progressiveMedia js-progressiveMedia"><img src="https://i.embed.ly/1/display/resize?url=https%3A%2F%2Fi.ytimg.com%2Fvi%2FVOC3huqHrss%2Fhqdefault.jpg&amp;key=a19fcc184b9711e1b4764040d3dc5c07&amp;width=40" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><div class="iframeContainer"><IFRAME data-width="854" data-height="480" width="700" height="393" data-src="/media/b901faec3876bb5da6091d9410fd9c72?postId=28b1b93e2088" data-media-id="b901faec3876bb5da6091d9410fd9c72" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Fi.ytimg.com%2Fvi%2FVOC3huqHrss%2Fhqdefault.jpg&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen frameborder="0"></IFRAME></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME data-width="854" data-height="480" width="700" height="393" src="/media/b901faec3876bb5da6091d9410fd9c72?postId=28b1b93e2088" data-media-id="b901faec3876bb5da6091d9410fd9c72" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Fi.ytimg.com%2Fvi%2FVOC3huqHrss%2Fhqdefault.jpg&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div><figcaption class="imageCaption">Object detection in real-time</figcaption></figure><p name="ff6b" id="ff6b" class="graf graf--p graf-after--figure">Let’s start with our own testing image below.</p><figure name="c0e3" id="c0e3" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 470px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 67.2%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*EYFejGUjvjPcc4PZTwoufw.jpeg" data-width="872" data-height="586" data-action="zoom" data-action-value="1*EYFejGUjvjPcc4PZTwoufw.jpeg"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*EYFejGUjvjPcc4PZTwoufw.jpeg?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*EYFejGUjvjPcc4PZTwoufw.jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*EYFejGUjvjPcc4PZTwoufw.jpeg"></noscript></div></div><figcaption class="imageCaption"><strong class="markup--strong markup--figure-strong">Testing image</strong></figcaption></figure><p name="acb9" id="acb9" class="graf graf--p graf-after--figure">The objects detected by YOLO:</p><figure name="6b18" id="6b18" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 470px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 67.2%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*QOGcvHbrDZiCqTG6THIQ_w.png" data-width="872" data-height="586" data-action="zoom" data-action-value="1*QOGcvHbrDZiCqTG6THIQ_w.png"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*QOGcvHbrDZiCqTG6THIQ_w.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*QOGcvHbrDZiCqTG6THIQ_w.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*QOGcvHbrDZiCqTG6THIQ_w.png"></noscript></div></div><figcaption class="imageCaption">Objects detected by YOLO.</figcaption></figure><p name="4bc0" id="4bc0" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Grid cell</strong></p><p name="65e3" id="65e3" class="graf graf--p graf-after--p">For our discussion, we crop our original photo. YOLO divides the input image into an <strong class="markup--strong markup--p-strong">S</strong>×<strong class="markup--strong markup--p-strong">S</strong> grid. Each grid cell predicts only <strong class="markup--strong markup--p-strong">one</strong> object. For example, the yellow grid cell below tries to predict the “person” object whose center (the blue dot) falls inside the grid cell.</p><figure name="f32c" id="f32c" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 411px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 58.699999999999996%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*6qZXYCDUkC5Bc8nRolT0Mw.jpeg" data-width="1139" data-height="669" data-action="zoom" data-action-value="1*6qZXYCDUkC5Bc8nRolT0Mw.jpeg"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*6qZXYCDUkC5Bc8nRolT0Mw.jpeg?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*6qZXYCDUkC5Bc8nRolT0Mw.jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*6qZXYCDUkC5Bc8nRolT0Mw.jpeg"></noscript></div></div><figcaption class="imageCaption">Each grid cell detects only one object.</figcaption></figure><p name="2220" id="2220" class="graf graf--p graf-after--figure">Each grid cell predicts a fixed number of boundary boxes. In this example, the yellow grid cell makes two boundary box predictions (blue boxes) to locate where the person is.</p><figure name="e9d1" id="e9d1" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 667px; max-height: 669px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100.29999999999998%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*4Y1PaY3ZgxKt5w84_0pNxw.jpeg" data-width="667" data-height="669"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*4Y1PaY3ZgxKt5w84_0pNxw.jpeg?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*4Y1PaY3ZgxKt5w84_0pNxw.jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*4Y1PaY3ZgxKt5w84_0pNxw.jpeg"></noscript></div></div><figcaption class="imageCaption">Each grid cell make a fixed number of boundary box guesses for the object.</figcaption></figure><p name="779b" id="779b" class="graf graf--p graf-after--figure">However, the one-object rule limits how close detected objects can be. For that, YOLO does have some limitations on how close objects can be. For the picture below, there are 9 Santas in the lower left corner but YOLO can detect 5 only.</p><figure name="45e6" id="45e6" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 428px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 61.1%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*j4PnWfxP3yoVPOFyI27tww.jpeg" data-width="3036" data-height="1855" data-is-featured="true" data-action="zoom" data-action-value="1*j4PnWfxP3yoVPOFyI27tww.jpeg"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*j4PnWfxP3yoVPOFyI27tww.jpeg?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*j4PnWfxP3yoVPOFyI27tww.jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*j4PnWfxP3yoVPOFyI27tww.jpeg"></noscript></div></div><figcaption class="imageCaption">YOLO may miss objects that are too close.</figcaption></figure><p name="d9cf" id="d9cf" class="graf graf--p graf-after--figure">For each grid cell,</p><ul class="postList"><li name="f040" id="f040" class="graf graf--li graf-after--p">it predicts <strong class="markup--strong markup--li-strong">B</strong> boundary boxes and each box has one <strong class="markup--strong markup--li-strong">box confidence score</strong>,</li><li name="23b9" id="23b9" class="graf graf--li graf-after--li">it detects <strong class="markup--strong markup--li-strong">one</strong> object only regardless of the number of boxes B,</li><li name="4e9c" id="4e9c" class="graf graf--li graf-after--li">it predicts <strong class="markup--strong markup--li-strong">C</strong> <strong class="markup--strong markup--li-strong">conditional class probabilities</strong> (one per class for the likeliness of the object class).</li></ul><p name="be90" id="be90" class="graf graf--p graf-after--li">To evaluate PASCAL VOC, YOLO uses 7×7 grids (S×S), 2 boundary boxes (B) and 20 classes (C).</p><figure name="ce26" id="ce26" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 449px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 64.1%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*OuMJUWo2rXYA-GYU63NUGw.jpeg" data-width="2113" data-height="1354" data-action="zoom" data-action-value="1*OuMJUWo2rXYA-GYU63NUGw.jpeg"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*OuMJUWo2rXYA-GYU63NUGw.jpeg?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*OuMJUWo2rXYA-GYU63NUGw.jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*OuMJUWo2rXYA-GYU63NUGw.jpeg"></noscript></div></div><figcaption class="imageCaption">YOYO make SxS predictions with B boundary boxes.</figcaption></figure><p name="5ef3" id="5ef3" class="graf graf--p graf-after--figure">Let’s get into more details. Each boundary box contains 5 elements: (<em class="markup--em markup--p-em">x, y, w, h</em>) and a <strong class="markup--strong markup--p-strong">box confidence score</strong>. The confidence score reflects how likely the box contains an object (<strong class="markup--strong markup--p-strong">objectness</strong>) and how accurate is the boundary box. We normalize the bounding box width <em class="markup--em markup--p-em">w</em> and height <em class="markup--em markup--p-em">h</em> by the image width and height. <em class="markup--em markup--p-em">x</em> and <em class="markup--em markup--p-em">y</em> are offsets to the corresponding cell. Hence, <em class="markup--em markup--p-em">x, y, w</em> and <em class="markup--em markup--p-em">h</em> are all between 0 and 1. Each cell has 20 conditional class probabilities. The <strong class="markup--strong markup--p-strong">conditional class probability</strong> is the probability that the detected object belongs to a particular class (one probability per category for each cell). So, YOLO’s prediction has a shape of (S, S, B×5 + C) = (7, 7, 2×5 + 20) = (7, 7, 30).</p><figure name="8ad8" id="8ad8" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 207px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 29.599999999999998%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*jtnrhMFNwGxiQmkY6LkdCQ.jpeg" data-width="804" data-height="238" data-action="zoom" data-action-value="1*jtnrhMFNwGxiQmkY6LkdCQ.jpeg"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*jtnrhMFNwGxiQmkY6LkdCQ.jpeg?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*jtnrhMFNwGxiQmkY6LkdCQ.jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*jtnrhMFNwGxiQmkY6LkdCQ.jpeg"></noscript></div></div><figcaption class="imageCaption"><a href="https://arxiv.org/pdf/1506.02640.pdf" data-href="https://arxiv.org/pdf/1506.02640.pdf" class="markup--anchor markup--figure-anchor" rel="noopener nofollow" target="_blank">Source</a></figcaption></figure><p name="03d4" id="03d4" class="graf graf--p graf-after--figure">The major concept of YOLO is to build a CNN network to predict a (7, 7, 30) tensor. It uses a CNN network to reduce the spatial dimension to 7×7 with 1024 output channels at each location. YOLO performs a linear regression using two fully connected layers to make 7×7×2 boundary box predictions (the middle picture below). To make a final prediction, we keep those with high box confidence scores (greater than 0.25) as our final predictions (the right picture).</p><figure name="dfc8" id="dfc8" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 191px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 27.3%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*e0VY6U1_WMF2KBoKQNZvkQ.png" data-width="1715" data-height="469" data-action="zoom" data-action-value="1*e0VY6U1_WMF2KBoKQNZvkQ.png"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*e0VY6U1_WMF2KBoKQNZvkQ.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*e0VY6U1_WMF2KBoKQNZvkQ.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*e0VY6U1_WMF2KBoKQNZvkQ.png"></noscript></div></div><figcaption class="imageCaption"><a href="https://pjreddie.com/darknet/yolo/" data-href="https://pjreddie.com/darknet/yolo/" class="markup--anchor markup--figure-anchor" rel="noopener nofollow" target="_blank">Source</a></figcaption></figure><p name="4733" id="4733" class="graf graf--p graf-after--figure">The <strong class="markup--strong markup--p-strong">class confidence score </strong>for each prediction box is computed as:</p><figure name="d818" id="d818" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 41px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 5.8999999999999995%;"></div><img class="graf-image" data-image-id="1*qVL77IZyEnra4DvENayXUA.png" data-width="1528" data-height="90" data-action="zoom" data-action-value="1*qVL77IZyEnra4DvENayXUA.png" src="https://cdn-images-1.medium.com/max/1200/1*qVL77IZyEnra4DvENayXUA.png"></div></figure><p name="7161" id="7161" class="graf graf--p graf-after--figure">It measures the confidence on both the classification and the <strong class="markup--strong markup--p-strong">localization</strong> (where an object is located).</p><p name="8084" id="8084" class="graf graf--p graf-after--p">We may mix up those scoring and probability terms easily. Here are the mathematical definitions for your future reference.</p><figure name="38d0" id="38d0" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 244px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 34.9%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*0IPktA65WxOBfP_ULQWcmw.png" data-width="1624" data-height="566" data-action="zoom" data-action-value="1*0IPktA65WxOBfP_ULQWcmw.png"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*0IPktA65WxOBfP_ULQWcmw.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*0IPktA65WxOBfP_ULQWcmw.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*0IPktA65WxOBfP_ULQWcmw.png"></noscript></div></div></figure><h3 name="5fe5" id="5fe5" class="graf graf--h3 graf-after--figure"><strong class="markup--strong markup--h3-strong">Network design</strong></h3></div><div class="section-inner sectionLayout--outsetColumn"><figure name="c3a9" id="c3a9" class="graf graf--figure graf--layoutOutsetCenter graf-after--h3"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1032px; max-height: 433px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 42%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*9ER4GVUtQGVA2Y0skC9OQQ.png" data-width="1920" data-height="806" data-action="zoom" data-action-value="1*9ER4GVUtQGVA2Y0skC9OQQ.png"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*9ER4GVUtQGVA2Y0skC9OQQ.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1800/1*9ER4GVUtQGVA2Y0skC9OQQ.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1800/1*9ER4GVUtQGVA2Y0skC9OQQ.png"></noscript></div></div><figcaption class="imageCaption"><a href="https://arxiv.org/pdf/1506.02640.pdf" data-href="https://arxiv.org/pdf/1506.02640.pdf" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">Source</a></figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="91ea" id="91ea" class="graf graf--p graf-after--figure">YOLO has 24 convolutional layers followed by 2 fully connected layers (FC). Some convolution layers use 1 × 1 reduction layers alternatively to reduce the depth of the features maps. For the last convolution layer, it outputs a tensor with shape (7, 7, 1024). The tensor is then flattened. Using 2 fully connected layers as a form of linear regression, it outputs 7×7×30 parameters and then reshapes to (7, 7, 30), i.e. 2 boundary box predictions per location.</p><p name="6672" id="6672" class="graf graf--p graf-after--p">A faster but less accurate version of YOLO, called Fast YOLO, uses only 9 convolutional layers with shallower feature maps.</p><h3 name="7bde" id="7bde" class="graf graf--h3 graf-after--p"><strong class="markup--strong markup--h3-strong">Loss function</strong></h3><p name="5db5" id="5db5" class="graf graf--p graf-after--h3">YOLO predicts multiple bounding boxes per grid cell. To compute the loss for the true positive, we only want one of them to be <strong class="markup--strong markup--p-strong">responsible</strong> for the object. For this purpose, we select the one with the highest IoU (intersection over union) with the ground truth. This strategy leads to specialization among the bounding box predictions. Each prediction gets better at predicting certain sizes and aspect ratios.</p><p name="8503" id="8503" class="graf graf--p graf-after--p">YOLO uses sum-squared error between the predictions and the ground truth to calculate loss. The loss function composes of:</p><ul class="postList"><li name="d975" id="d975" class="graf graf--li graf-after--p">the <strong class="markup--strong markup--li-strong">classification loss</strong>.</li><li name="ef04" id="ef04" class="graf graf--li graf-after--li">the <strong class="markup--strong markup--li-strong">localization loss</strong> (errors between the predicted boundary box and the ground truth).</li><li name="718c" id="718c" class="graf graf--li graf-after--li">the <strong class="markup--strong markup--li-strong">confidence loss</strong> (the objectness of the box).</li></ul><p name="b1d2" id="b1d2" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">Classification loss</strong></p><p name="4291" id="4291" class="graf graf--p graf-after--p">If <em class="markup--em markup--p-em">an object is detected</em>, the classification loss at each cell is the squared error of the class conditional probabilities for each class:</p><figure name="b3b1" id="b3b1" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 209px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 29.799999999999997%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*lF6SCAVj5jMwLxs39SCogw.png" data-width="1454" data-height="434" data-action="zoom" data-action-value="1*lF6SCAVj5jMwLxs39SCogw.png"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*lF6SCAVj5jMwLxs39SCogw.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*lF6SCAVj5jMwLxs39SCogw.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*lF6SCAVj5jMwLxs39SCogw.png"></noscript></div></div></figure><p name="7476" id="7476" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Localization loss</strong></p><p name="e7fa" id="e7fa" class="graf graf--p graf-after--p">The localization loss measures the errors in the predicted boundary box locations and sizes. We only count the box responsible for detecting the object.</p><figure name="3877" id="3877" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 267px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 38.2%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*BwhGMvffFfqtND9413oiwA.png" data-width="1598" data-height="610" data-action="zoom" data-action-value="1*BwhGMvffFfqtND9413oiwA.png"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*BwhGMvffFfqtND9413oiwA.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*BwhGMvffFfqtND9413oiwA.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*BwhGMvffFfqtND9413oiwA.png"></noscript></div></div></figure><p name="890d" id="890d" class="graf graf--p graf-after--figure">We do not want to weight absolute errors in large boxes and small boxes equally. i.e. a 2-pixel error in a large box is the same for a small box. To partially address this, YOLO predicts the square root of the bounding box width and height instead of the width and height. In addition, to put more emphasis on the boundary box accuracy, we multiply the loss by λ<em class="markup--em markup--p-em">coord</em> (default: 5).</p><p name="34aa" id="34aa" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Confidence loss</strong></p><p name="d347" id="d347" class="graf graf--p graf-after--p">If <em class="markup--em markup--p-em">an object is detected in the box</em>, the confidence loss (measuring the objectness of the box) is:</p><figure name="1563" id="1563" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 196px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 28.000000000000004%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*QT7mwEbyLJYIxTYtOWClFQ.png" data-width="1658" data-height="464" data-action="zoom" data-action-value="1*QT7mwEbyLJYIxTYtOWClFQ.png"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*QT7mwEbyLJYIxTYtOWClFQ.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*QT7mwEbyLJYIxTYtOWClFQ.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*QT7mwEbyLJYIxTYtOWClFQ.png"></noscript></div></div></figure><p name="6918" id="6918" class="graf graf--p graf-after--figure">If <em class="markup--em markup--p-em">an object is not detected in the box</em>, the confidence loss is:</p><figure name="74ef" id="74ef" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 252px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 36%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*Yc_OJIXOoV2WaGQ6PqhTXA.png" data-width="1526" data-height="550" data-action="zoom" data-action-value="1*Yc_OJIXOoV2WaGQ6PqhTXA.png"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*Yc_OJIXOoV2WaGQ6PqhTXA.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*Yc_OJIXOoV2WaGQ6PqhTXA.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*Yc_OJIXOoV2WaGQ6PqhTXA.png"></noscript></div></div></figure><p name="ca3e" id="ca3e" class="graf graf--p graf-after--figure">Most boxes do not contain any objects. This causes a class imbalance problem, i.e. we train the model to detect background more frequently than detecting objects. To remedy this, we weight this loss down by a factor λ<em class="markup--em markup--p-em">noobj</em> (default: 0.5).</p><p name="e037" id="e037" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Loss</strong></p><p name="a20c" id="a20c" class="graf graf--p graf-after--p">The final loss adds localization, confidence and classification losses together.</p><figure name="08f1" id="08f1" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 327px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 46.6%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*aW6htqx4Q7APLrSQg2eWDw.png" data-width="1372" data-height="640" data-action="zoom" data-action-value="1*aW6htqx4Q7APLrSQg2eWDw.png"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*aW6htqx4Q7APLrSQg2eWDw.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*aW6htqx4Q7APLrSQg2eWDw.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*aW6htqx4Q7APLrSQg2eWDw.png"></noscript></div></div><figcaption class="imageCaption"><a href="https://arxiv.org/pdf/1506.02640.pdf" data-href="https://arxiv.org/pdf/1506.02640.pdf" class="markup--anchor markup--figure-anchor" rel="noopener nofollow" target="_blank">Source</a></figcaption></figure><h3 name="7519" id="7519" class="graf graf--h3 graf-after--figure">Inference: Non-maximal suppression</h3><p name="9c17" id="9c17" class="graf graf--p graf-after--h3">YOLO can make duplicate detections for the same object. To fix this, YOLO applies non-maximal suppression to remove duplications with lower confidence. Non-maximal suppression adds 2- 3% in mAP.</p><p name="a146" id="a146" class="graf graf--p graf-after--p">Here is one of the possible non-maximal suppression implementation:</p><ol class="postList"><li name="9fab" id="9fab" class="graf graf--li graf-after--p">Sort the predictions by the confidence scores.</li><li name="7185" id="7185" class="graf graf--li graf-after--li">Start from the top scores, ignore any current prediction if we find any previous predictions that have the same class and IoU &gt; 0.5 with the current prediction.</li><li name="691a" id="691a" class="graf graf--li graf-after--li">Repeat step 2 until all predictions are checked.</li></ol><h3 name="73bf" id="73bf" class="graf graf--h3 graf-after--li"><strong class="markup--strong markup--h3-strong">Benefits of YOLO</strong></h3><ul class="postList"><li name="49ce" id="49ce" class="graf graf--li graf-after--h3">Fast. Good for real-time processing.</li><li name="0c9b" id="0c9b" class="graf graf--li graf-after--li">Predictions (object locations and classes) are made from one single network. Can be trained end-to-end to improve accuracy.</li><li name="4722" id="4722" class="graf graf--li graf-after--li">YOLO is more generalized. It outperforms other methods when generalizing from natural images to other domains like artwork.</li></ul><figure name="382f" id="382f" class="graf graf--figure graf-after--li"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 249px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 35.6%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*XbOnbcZmc50hyhhTwhD5QA.png" data-width="2140" data-height="762" data-action="zoom" data-action-value="1*XbOnbcZmc50hyhhTwhD5QA.png"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*XbOnbcZmc50hyhhTwhD5QA.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*XbOnbcZmc50hyhhTwhD5QA.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*XbOnbcZmc50hyhhTwhD5QA.png"></noscript></div></div></figure><ul class="postList"><li name="d34b" id="d34b" class="graf graf--li graf-after--figure">Region proposal methods limit the classifier to the specific region. YOLO accesses to the whole image in predicting boundaries. With the additional context, YOLO demonstrates fewer false positives in background areas.</li><li name="fb3f" id="fb3f" class="graf graf--li graf-after--li">YOLO detects one object per grid cell. It enforces spatial diversity in making predictions.</li></ul><h3 name="77ea" id="77ea" class="graf graf--h3 graf-after--li">YOLOv2</h3><p name="2df6" id="2df6" class="graf graf--p graf-after--h3">SSD is a strong competitor for YOLO which at one point demonstrates higher accuracy for real-time processing. Comparing with region based detectors, YOLO has higher localization errors and the recall (measure how good to locate all objects) is lower. YOLOv2 is the second version of the YOLO with the objective of improving the accuracy significantly while making it faster.</p><h3 name="12a7" id="12a7" class="graf graf--h3 graf-after--p">Accuracy improvements</h3><p name="63fc" id="63fc" class="graf graf--p graf-after--h3"><strong class="markup--strong markup--p-strong">Batch normalization</strong></p><p name="34ba" id="34ba" class="graf graf--p graf-after--p">Add batch normalization in convolution layers. This removes the need for dropouts and pushes mAP up 2%.</p><p name="f021" id="f021" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">High-resolution classifier</strong></p><p name="6a6d" id="6a6d" class="graf graf--p graf-after--p">The YOLO training composes of 2 phases. First, we train a classifier network like VGG16. Then we replace the fully connected layers with a convolution layer and retrain it end-to-end for the object detection. YOLO trains the classifier with 224 × 224 pictures followed by 448 × 448 pictures for the object detection. YOLOv2 starts with 224 × 224 pictures for the classifier training but then retune the classifier again with 448 × 448 pictures using much fewer epochs. This makes the detector training easier and moves mAP up by 4%.</p><p name="afa6" id="afa6" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Convolutional with Anchor Boxes</strong></p><p name="77f0" id="77f0" class="graf graf--p graf-after--p">As indicated in the <a href="https://arxiv.org/pdf/1506.02640.pdf" data-href="https://arxiv.org/pdf/1506.02640.pdf" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">YOLO paper</a>, the early training is susceptible to unstable gradients. Initially, YOLO makes arbitrary guesses on the boundary boxes. These guesses may work well for some objects but badly for others resulting in steep gradient changes. In early training, predictions are fighting with each other on what shapes to specialize on.</p><figure name="5762" id="5762" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 691px; max-height: 498px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 72.1%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*7iwTsezrn-tSndx96twprA.jpeg" data-width="691" data-height="498"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*7iwTsezrn-tSndx96twprA.jpeg?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*7iwTsezrn-tSndx96twprA.jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*7iwTsezrn-tSndx96twprA.jpeg"></noscript></div></div></figure><p name="4704" id="4704" class="graf graf--p graf-after--figure">In the real-life domain, the boundary boxes are not arbitrary. Cars have very similar shapes and pedestrians have an approximate aspect ratio of 0.41.</p><figure name="c23c" id="c23c" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 372px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 53.1%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*krGqonOLMzSE_PWqH_LvQA.jpeg" data-width="2688" data-height="1428" data-action="zoom" data-action-value="1*krGqonOLMzSE_PWqH_LvQA.jpeg"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*krGqonOLMzSE_PWqH_LvQA.jpeg?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*krGqonOLMzSE_PWqH_LvQA.jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*krGqonOLMzSE_PWqH_LvQA.jpeg"></noscript></div></div><figcaption class="imageCaption"><a href="https://www.youtube.com/watch?v=xVwsr9p3irA" data-href="https://www.youtube.com/watch?v=xVwsr9p3irA" class="markup--anchor markup--figure-anchor" rel="noopener nofollow" target="_blank">Source</a></figcaption></figure><p name="4c68" id="4c68" class="graf graf--p graf-after--figure">Since we only need one guess to be right, the initial training will be more stable if we start with diverse guesses that are common for real-life objects.</p><figure name="763e" id="763e" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 691px; max-height: 498px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 72.1%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*CGWTPTY0sfvQoxsS0X6VFg.jpeg" data-width="691" data-height="498"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*CGWTPTY0sfvQoxsS0X6VFg.jpeg?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*CGWTPTY0sfvQoxsS0X6VFg.jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*CGWTPTY0sfvQoxsS0X6VFg.jpeg"></noscript></div></div><figcaption class="imageCaption">More diverse predictions</figcaption></figure><p name="3040" id="3040" class="graf graf--p graf-after--figure">For example, we can create 5 <strong class="markup--strong markup--p-strong">anchor</strong> boxes with the following shapes.</p><figure name="db1e" id="db1e" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 504px; max-height: 227px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 45%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*8Q8r9ixjTiKLi1mrF36xCw.jpeg" data-width="504" data-height="227"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*8Q8r9ixjTiKLi1mrF36xCw.jpeg?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*8Q8r9ixjTiKLi1mrF36xCw.jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*8Q8r9ixjTiKLi1mrF36xCw.jpeg"></noscript></div></div><figcaption class="imageCaption">5 anchor boxes</figcaption></figure><p name="8507" id="8507" class="graf graf--p graf-after--figure">Instead of predicting 5 arbitrary boundary boxes, we predict offsets to each of the anchor boxes above. If we <strong class="markup--strong markup--p-strong">constrain</strong> the offset values, we can maintain the diversity of the predictions and have each prediction focuses on a specific shape. So the initial training will be more stable.</p><blockquote name="2366" id="2366" class="graf graf--blockquote graf-after--p">In the paper, anchors are also called <strong class="markup--strong markup--blockquote-strong">priors</strong>.</blockquote><p name="4b0b" id="4b0b" class="graf graf--p graf-after--blockquote">Here are the changes we make to the network:</p><ul class="postList"><li name="dd5b" id="dd5b" class="graf graf--li graf-after--p">Remove the fully connected layers responsible for predicting the boundary box.</li></ul><figure name="12f2" id="12f2" class="graf graf--figure graf-after--li"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 296px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 42.3%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*tavjieD0Bum_uX-svYUTKA.jpeg" data-width="1904" data-height="806" data-action="zoom" data-action-value="1*tavjieD0Bum_uX-svYUTKA.jpeg"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*tavjieD0Bum_uX-svYUTKA.jpeg?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*tavjieD0Bum_uX-svYUTKA.jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*tavjieD0Bum_uX-svYUTKA.jpeg"></noscript></div></div></figure><ul class="postList"><li name="4874" id="4874" class="graf graf--li graf-after--figure">We move the class prediction from the cell level to the boundary box level. Now, each prediction includes 4 parameters for the boundary box, 1 box confidence score (objectness) and 20 class probabilities. i.e. 5 boundary boxes with 25 parameters: 125 parameters per grid cell. Same as YOLO, the objectness prediction still predicts the IOU of the ground truth and the proposed box.</li></ul><figure name="7c2e" id="7c2e" class="graf graf--figure graf-after--li"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 318px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 45.5%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*UsqjfoW3sLkmyXKQ0Hyo8A.png" data-width="1047" data-height="476" data-action="zoom" data-action-value="1*UsqjfoW3sLkmyXKQ0Hyo8A.png"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*UsqjfoW3sLkmyXKQ0Hyo8A.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*UsqjfoW3sLkmyXKQ0Hyo8A.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*UsqjfoW3sLkmyXKQ0Hyo8A.png"></noscript></div></div></figure><ul class="postList"><li name="0298" id="0298" class="graf graf--li graf-after--figure">To generate predictions with a shape of 7 × 7 × 125, we replace the last convolution layer with three 3 × 3 convolutional layers each outputting 1024 output channels. Then we apply a final 1 × 1 convolutional layer to convert the 7 × 7 × 1024 output into 7 × 7 × 125. (See the section on DarkNet for the details.)</li></ul><figure name="b734" id="b734" class="graf graf--figure graf-after--li"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 418px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 59.699999999999996%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*KiSd2CBfcs5af6oliHCqzw.jpeg" data-width="1579" data-height="943" data-action="zoom" data-action-value="1*KiSd2CBfcs5af6oliHCqzw.jpeg"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*KiSd2CBfcs5af6oliHCqzw.jpeg?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*KiSd2CBfcs5af6oliHCqzw.jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*KiSd2CBfcs5af6oliHCqzw.jpeg"></noscript></div></div><figcaption class="imageCaption">Using convolution filters to make predictions.</figcaption></figure><ul class="postList"><li name="ef2c" id="ef2c" class="graf graf--li graf-after--figure">Change the input image size from 448 × 448 to 416 × 416. This creates an odd number spatial dimension (7×7 v.s. 8×8 grid cell). The center of a picture is often occupied by a large object. With an odd number grid cell, it is more certain on where the object belongs.</li></ul><figure name="a764" id="a764" class="graf graf--figure graf-after--li"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 323px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 46.1%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*89qezEeLKJLpD8_fM_H4qQ.jpeg" data-width="822" data-height="379" data-action="zoom" data-action-value="1*89qezEeLKJLpD8_fM_H4qQ.jpeg"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*89qezEeLKJLpD8_fM_H4qQ.jpeg?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*89qezEeLKJLpD8_fM_H4qQ.jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*89qezEeLKJLpD8_fM_H4qQ.jpeg"></noscript></div></div></figure><ul class="postList"><li name="7155" id="7155" class="graf graf--li graf-after--figure">Remove one pooling layer to make the spatial output of the network to <strong class="markup--strong markup--li-strong">13×13 </strong>(instead of 7×7).</li></ul><p name="9de4" id="9de4" class="graf graf--p graf-after--li">Anchor boxes decrease mAP slightly from 69.5 to 69.2 but the recall improves from 81% to 88%. i.e. even the accuracy is slightly decreased but it increases the chances of detecting all the ground truth objects.</p><p name="6c07" id="6c07" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Dimension Clusters</strong></p><p name="ea00" id="ea00" class="graf graf--p graf-after--p">In many problem domains, the boundary boxes have strong patterns. For example, in the autonomous driving, the 2 most common boundary boxes will be cars and pedestrians at different distances. To identify the top-K boundary boxes that have the best coverage for the training data, we run K-means clustering on the training data to locate the centroids of the top-K clusters.</p><figure name="d8a6" id="d8a6" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 388px; max-height: 298px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 76.8%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*esSmI0UaMr-GrqkUGMg0hA.jpeg" data-width="388" data-height="298"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*esSmI0UaMr-GrqkUGMg0hA.jpeg?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*esSmI0UaMr-GrqkUGMg0hA.jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*esSmI0UaMr-GrqkUGMg0hA.jpeg"></noscript></div></div><figcaption class="imageCaption">(Image modified form <a href="https://mapr.com/blog/monitoring-real-time-uber-data-using-spark-machine-learning-streaming-and-kafka-api-part-1/" data-href="https://mapr.com/blog/monitoring-real-time-uber-data-using-spark-machine-learning-streaming-and-kafka-api-part-1/" class="markup--anchor markup--figure-anchor" rel="noopener nofollow" target="_blank">a k-means cluster</a>)</figcaption></figure><p name="0b47" id="0b47" class="graf graf--p graf-after--figure">Since we are dealing with boundary boxes rather than points, we cannot use the regular spatial distance to measure datapoint distances. No surprise, we use IoU.</p><figure name="b048" id="b048" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 371px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 53%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*l5wvrPjLlFp6Whgy0MqbKQ.png" data-width="1114" data-height="590" data-action="zoom" data-action-value="1*l5wvrPjLlFp6Whgy0MqbKQ.png"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*l5wvrPjLlFp6Whgy0MqbKQ.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*l5wvrPjLlFp6Whgy0MqbKQ.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*l5wvrPjLlFp6Whgy0MqbKQ.png"></noscript></div></div><figcaption class="imageCaption"><a href="https://arxiv.org/pdf/1612.08242.pdf" data-href="https://arxiv.org/pdf/1612.08242.pdf" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">Source</a></figcaption></figure><p name="a0d7" id="a0d7" class="graf graf--p graf-after--figure">On the left, we plot the average IoU between the anchors and the ground truth boxes using different numbers of clusters (anchors). As the number of anchors increases, the accuracy improvement plateaus. For the best return, YOLO settles down with 5 anchors. On the right, it displays the 5 anchors’ shapes. The purplish-blue rectangles are selected from the COCO dataset while the black border rectangles are selected from the VOC2007. In both cases, we have more thin and tall anchors indicating that real-life boundary boxes are not arbitrary.</p><blockquote name="ae5e" id="ae5e" class="graf graf--blockquote graf-after--p">Unless we are comparing YOLO and YOLOv2, we will reference YOLOv2 as YOLO for now.</blockquote><p name="0780" id="0780" class="graf graf--p graf-after--blockquote"><strong class="markup--strong markup--p-strong">Direct location prediction</strong></p><p name="d58d" id="d58d" class="graf graf--p graf-after--p">We make predictions on the offsets to the anchors. Nevertheless, if it is unconstrained, our guesses will be randomized again. YOLO predicts 5 parameters (t<em class="markup--em markup--p-em">x</em>, t<em class="markup--em markup--p-em">y</em>, t<em class="markup--em markup--p-em">w</em>, t<em class="markup--em markup--p-em">h</em>, and t<em class="markup--em markup--p-em">o</em>) and applies the sigma function to constraint its possible offset range.</p><figure name="06b8" id="06b8" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 465px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 66.4%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*38-Tdx-wQA7c3TX5hdnwpw.jpeg" data-width="1536" data-height="1020" data-action="zoom" data-action-value="1*38-Tdx-wQA7c3TX5hdnwpw.jpeg"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*38-Tdx-wQA7c3TX5hdnwpw.jpeg?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*38-Tdx-wQA7c3TX5hdnwpw.jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*38-Tdx-wQA7c3TX5hdnwpw.jpeg"></noscript></div></div></figure><p name="60ab" id="60ab" class="graf graf--p graf-after--figure">Here is the visualization. The blue box below is the predicted boundary box and the dotted rectangle is the anchor.</p><figure name="7034" id="7034" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 529px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 75.6%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*gyOSRA_FDz4Pf5njoUb4KQ.jpeg" data-width="1214" data-height="918" data-action="zoom" data-action-value="1*gyOSRA_FDz4Pf5njoUb4KQ.jpeg"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*gyOSRA_FDz4Pf5njoUb4KQ.jpeg?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*gyOSRA_FDz4Pf5njoUb4KQ.jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*gyOSRA_FDz4Pf5njoUb4KQ.jpeg"></noscript></div></div><figcaption class="imageCaption">Modified from the <a href="https://arxiv.org/pdf/1612.08242.pdf" data-href="https://arxiv.org/pdf/1612.08242.pdf" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">paper</a>.</figcaption></figure><p name="91a9" id="91a9" class="graf graf--p graf-after--figure">With the use of k-means clustering (dimension clusters) and the improvement mentioned in this section, mAP increases 5%.</p><p name="5583" id="5583" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Fine-Grained Features</strong></p><p name="2313" id="2313" class="graf graf--p graf-after--p">Convolution layers decrease the spatial dimension gradually. As the corresponding resolution decreases, it is harder to detect small objects. Other object detectors like SSD locate objects from different layers of feature maps. So each layer specializes at a different scale. YOLO adopts a different approach called passthrough. It reshapes the 28 × 28 × 512 layer to 14 × 14 × 2048. Then it concatenates with the original 14 × 14 ×1024 output layer. Now we apply convolution filters on the new 14 × 14 × 3072 layer to make predictions.</p><figure name="aa05" id="aa05" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 151px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 21.6%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*3fLdTcbKEeeQAt4mt9LnFQ.jpeg" data-width="1696" data-height="366" data-action="zoom" data-action-value="1*3fLdTcbKEeeQAt4mt9LnFQ.jpeg"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*3fLdTcbKEeeQAt4mt9LnFQ.jpeg?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*3fLdTcbKEeeQAt4mt9LnFQ.jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*3fLdTcbKEeeQAt4mt9LnFQ.jpeg"></noscript></div></div></figure><p name="32a7" id="32a7" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Multi-Scale Training</strong></p><p name="3c3d" id="3c3d" class="graf graf--p graf-after--p">After removing the fully connected layers, YOLO can take images of different sizes. If the width and height are doubled, we are just making 4x output grid cells and therefore 4x predictions. Since the YOLO network downsamples the input by 32, we just need to make sure the width and height is a multiple of 32. During training, YOLO takes images of size 320×320, 352×352, … and 608×608 (with a step of 32). For every 10 batches, YOLOv2 randomly selects another image size to train the model. This acts as data augmentation and forces the network to predict well for different input image dimension and scale. In additional, we can use lower resolution images for object detection at the cost of accuracy. This can be a good tradeoff for speed on low GPU power devices. At 288 × 288 YOLO runs at more than 90 FPS with mAP almost as good as Fast R-CNN. At high-resolution YOLO achieves 78.6 mAP on VOC 2007.</p><h3 name="8d9e" id="8d9e" class="graf graf--h3 graf-after--p"><strong class="markup--strong markup--h3-strong">Accuracy</strong></h3><p name="97e0" id="97e0" class="graf graf--p graf-after--h3">Here is the accuracy improvements after applying the techniques discussed so far:</p><figure name="d6c3" id="d6c3" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 289px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 41.3%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*3IdCKSzR5R0lIE1LSmN4Bg.png" data-width="1568" data-height="648" data-action="zoom" data-action-value="1*3IdCKSzR5R0lIE1LSmN4Bg.png"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*3IdCKSzR5R0lIE1LSmN4Bg.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*3IdCKSzR5R0lIE1LSmN4Bg.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*3IdCKSzR5R0lIE1LSmN4Bg.png"></noscript></div></div><figcaption class="imageCaption"><a href="https://arxiv.org/pdf/1612.08242.pdf" data-href="https://arxiv.org/pdf/1612.08242.pdf" class="markup--anchor markup--figure-anchor" rel="noopener nofollow" target="_blank">Source</a></figcaption></figure><p name="1739" id="1739" class="graf graf--p graf-after--figure">Accuracy comparison for different detectors:</p><figure name="5ec1" id="5ec1" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 462px; max-height: 325px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 70.3%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*NJj17Z6FgffYaA4WH2WIjw.png" data-width="462" data-height="325"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*NJj17Z6FgffYaA4WH2WIjw.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*NJj17Z6FgffYaA4WH2WIjw.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*NJj17Z6FgffYaA4WH2WIjw.png"></noscript></div></div><figcaption class="imageCaption"><a href="https://arxiv.org/pdf/1612.08242.pdf" data-href="https://arxiv.org/pdf/1612.08242.pdf" class="markup--anchor markup--figure-anchor" rel="noopener nofollow" target="_blank">Source</a></figcaption></figure><h3 name="0d9a" id="0d9a" class="graf graf--h3 graf-after--figure">Speed improvement</h3><p name="89bb" id="89bb" class="graf graf--p graf-after--h3"><strong class="markup--strong markup--p-strong">GoogLeNet</strong></p><p name="34c3" id="34c3" class="graf graf--p graf-after--p">VGG16 requires 30.69 billion floating point operations for a single pass over a 224 × 224 image versus 8.52 billion operations for a customized GoogLeNet. We can replace the VGG16 with the customized GoogLeNet. However, YOLO pays a price on the top-5 accuracy for ImageNet: accuracy drops from 90.0% to 88.0%.</p><p name="4eea" id="4eea" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">DarkNet</strong></p><p name="e314" id="e314" class="graf graf--p graf-after--p">We can further simplify the backbone CNN used. Darknet requires 5.58 billion operations only. With DarkNet, YOLO achieves 72.9% top-1 accuracy and 91.2% top-5 accuracy on ImageNet. Darknet uses mostly 3 × 3 filters to extract features and 1 × 1 filters to reduce output channels. It also uses global average pooling to make predictions. Here is the detail network description:</p><figure name="3e5c" id="3e5c" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 464px; max-height: 598px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 128.9%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*8FiQUakp9i4MneU4VXk4Ww.png" data-width="464" data-height="598"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*8FiQUakp9i4MneU4VXk4Ww.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*8FiQUakp9i4MneU4VXk4Ww.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*8FiQUakp9i4MneU4VXk4Ww.png"></noscript></div></div><figcaption class="imageCaption">Modified from <a href="https://arxiv.org/pdf/1612.08242.pdf" data-href="https://arxiv.org/pdf/1612.08242.pdf" class="markup--anchor markup--figure-anchor" rel="noopener nofollow" target="_blank">source</a></figcaption></figure><p name="d0d9" id="d0d9" class="graf graf--p graf-after--figure">We replace the last convolution layer (the cross-out section) with three 3 × 3 convolutional layers each outputting 1024 output channels. Then we apply a final 1 × 1 convolutional layer to convert the 7 × 7 × 1024 output into 7 × 7 × 125. (5 boundary boxes each with 4 parameters for the box, 1 objectness score and 20 conditional class probabilities)</p></div><div class="section-inner sectionLayout--outsetColumn"><figure name="970d" id="970d" class="graf graf--figure graf--layoutOutsetCenter graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1032px; max-height: 121px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 11.799999999999999%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*NBnDpz8fitkhcdnkgF2bvg.png" data-width="1794" data-height="211" data-action="zoom" data-action-value="1*NBnDpz8fitkhcdnkgF2bvg.png"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*NBnDpz8fitkhcdnkgF2bvg.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1800/1*NBnDpz8fitkhcdnkgF2bvg.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1800/1*NBnDpz8fitkhcdnkgF2bvg.png"></noscript></div></div><figcaption class="imageCaption">YOLO with DarkNet</figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><h3 name="7726" id="7726" class="graf graf--h3 graf-after--figure">Training</h3><p name="9a43" id="9a43" class="graf graf--p graf-after--h3">YOLO is trained with the ImageNet 1000 class classification dataset in 160 epochs: using stochastic gradient descent with a starting learning rate of 0.1, polynomial rate decay with a power of 4, weight decay of 0.0005 and momentum of 0.9. In the initial training, YOLO uses 224 × 224 images, and then retune it with 448× 448 images for 10 epochs at a 10−3 learning rate. After the training, the classifier achieves a top-1 accuracy of 76.5% and a top-5 accuracy of 93.3%.</p><p name="406c" id="406c" class="graf graf--p graf-after--p">Then the fully connected layers and the last convolution layer is removed for a detector. YOLO adds three 3 × 3 convolutional layers with 1024 filters each followed by a final 1 × 1 convolutional layer with 125 output channels. (5 box predictions each with 25 parameters) YOLO also add a passthrough layer. YOLO trains the network for 160 epochs with a starting learning rate of 10−3 , dividing it by 10 at 60 and 90 epochs. YOLO uses a weight decay of 0.0005 and momentum of 0.9.</p><h3 name="c14b" id="c14b" class="graf graf--h3 graf-after--p"><strong class="markup--strong markup--h3-strong">Classification</strong></h3><p name="9aa2" id="9aa2" class="graf graf--p graf-after--h3">Datasets for object detection have far fewer class categories than those for classification. To expand the classes that YOLO can detect, YOLO proposes a method to mix images from both detection and classification datasets during training. It trains the end-to-end network with the object detection samples while backpropagates the classification loss from the classification samples to train the classifier path. This approach encounters a few challenges:</p><ul class="postList"><li name="a98e" id="a98e" class="graf graf--li graf-after--p">How do we merge class labels from different datasets? In particular, object detection datasets and different classification datasets uses different labels.</li><li name="0d6b" id="0d6b" class="graf graf--li graf-after--li">Any merged labels may not be mutually exclusive, for example, <em class="markup--em markup--li-em">Norfolk terrier</em> in ImageNet and <em class="markup--em markup--li-em">dog </em>in COCO. Since it is not mutually exclusive, we can not use softmax to compute the probability.</li></ul><p name="ed9e" id="ed9e" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">Hierarchical classification</strong></p><p name="92f9" id="92f9" class="graf graf--p graf-after--p">Without going into details, YOLO combines labels in different datasets to form a tree-like structure <strong class="markup--strong markup--p-strong">WordTree</strong>. The children form an is-a relationship with its parent like biplane is a plane. But the merged labels are now not mutually exclusive.</p><figure name="3704" id="3704" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 720px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 102.89999999999999%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*QKwSclDLcT8eJxyj3CVL0w.png" data-width="1440" data-height="1482" data-action="zoom" data-action-value="1*QKwSclDLcT8eJxyj3CVL0w.png"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*QKwSclDLcT8eJxyj3CVL0w.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*QKwSclDLcT8eJxyj3CVL0w.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*QKwSclDLcT8eJxyj3CVL0w.png"></noscript></div></div><figcaption class="imageCaption">Combining COCO and ImageNet labels to a hierarchical WordTree (<a href="https://arxiv.org/pdf/1612.08242.pdf" data-href="https://arxiv.org/pdf/1612.08242.pdf" class="markup--anchor markup--figure-anchor" rel="noopener nofollow" target="_blank">source</a>)</figcaption></figure><p name="3bec" id="3bec" class="graf graf--p graf-after--figure">Let’s simplify the discussion using the 1000 class ImageNet. Instead of predicting 1000 labels in a flat structure, we create the corresponding WordTree which has 1000 leave nodes for the original labels and 369 nodes for their parent classes. Originally, YOLO predicts the class score for the biplane. But with the WordTree, it now predicts the score for the biplane given it is an airplane.</p><figure name="e2b5" id="e2b5" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 27px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 3.8%;"></div><img class="graf-image" data-image-id="1*TALo1-LuWbF80RTCM7bszw.png" data-width="1562" data-height="60" data-action="zoom" data-action-value="1*TALo1-LuWbF80RTCM7bszw.png" src="https://cdn-images-1.medium.com/max/1200/1*TALo1-LuWbF80RTCM7bszw.png"></div></figure><p name="2381" id="2381" class="graf graf--p graf-after--figure">Since</p><figure name="e1bf" id="e1bf" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 41px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 5.800000000000001%;"></div><img class="graf-image" data-image-id="1*0Oyd6FWXo7OJzzuXuXSoDQ.png" data-width="1554" data-height="90" data-action="zoom" data-action-value="1*0Oyd6FWXo7OJzzuXuXSoDQ.png" src="https://cdn-images-1.medium.com/max/1200/1*0Oyd6FWXo7OJzzuXuXSoDQ.png"></div></figure><p name="132d" id="132d" class="graf graf--p graf-after--figure">we can apply a softmax function to compute the probability</p><figure name="4a97" id="4a97" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 31px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 4.3999999999999995%;"></div><img class="graf-image" data-image-id="1*_gX42bmgvyib4lyR9GQrAg.png" data-width="1576" data-height="70" data-action="zoom" data-action-value="1*_gX42bmgvyib4lyR9GQrAg.png" src="https://cdn-images-1.medium.com/max/1200/1*_gX42bmgvyib4lyR9GQrAg.png"></div></figure><p name="83de" id="83de" class="graf graf--p graf-after--figure">from the scores of its own and the siblings. The difference is, instead of one softmax operations, YOLO performs multiple softmax operations for each parent’s children.</p><figure name="7b7d" id="7b7d" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 386px; max-height: 329px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 85.2%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*_0ijX5oRZdQCNlSk-gXj3Q.jpeg" data-width="386" data-height="329"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*_0ijX5oRZdQCNlSk-gXj3Q.jpeg?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*_0ijX5oRZdQCNlSk-gXj3Q.jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*_0ijX5oRZdQCNlSk-gXj3Q.jpeg"></noscript></div></div><figcaption class="imageCaption"><a href="https://arxiv.org/pdf/1612.08242.pdf" data-href="https://arxiv.org/pdf/1612.08242.pdf" class="markup--anchor markup--figure-anchor" rel="noopener nofollow" target="_blank">source</a></figcaption></figure><p name="c923" id="c923" class="graf graf--p graf-after--figure">The class probability is then computed from the YOLO predictions by going up the WordTree.</p><figure name="0e48" id="0e48" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 106px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 15.1%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*0XHKAh0GxpW22y1DlL4hYA.png" data-width="1578" data-height="238" data-action="zoom" data-action-value="1*0XHKAh0GxpW22y1DlL4hYA.png"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*0XHKAh0GxpW22y1DlL4hYA.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*0XHKAh0GxpW22y1DlL4hYA.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*0XHKAh0GxpW22y1DlL4hYA.png"></noscript></div></div></figure><p name="bc6c" id="bc6c" class="graf graf--p graf-after--figure">For classification, we assume an object is already detected and therefore Pr(physical object)=1.</p><p name="5c22" id="5c22" class="graf graf--p graf-after--p">One benefit of the hierarchy classification is that when YOLO cannot distinguish the type of airplane, it gives a high score to the airplane instead of forcing it into one of the sub-categories.</p><p name="b4cc" id="b4cc" class="graf graf--p graf-after--p">When YOLO sees a classification image, it only backpropagates classification loss to train the classifier. YOLO finds the bounding box that predicts the highest probability for that class and it computes the classification loss as well as those from the parents. (If an object is labeled as a biplane, it is also considered to be labeled as airplane, air, vehicle… ) This encourages the model to extract features common to them. So even we have never trained a specific class of objects for object detection, we can still make such predictions by generalizing predictions from related objects.</p><p name="0011" id="0011" class="graf graf--p graf-after--p">In object detection, we set Pr(physical object) equals to the box confidence score which measures whether the box has an object. YOLO traverses down the tree, taking the highest confidence path at every split until it reaches some threshold and YOLO predicts that object class.</p><p name="9465" id="9465" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">YOLO9000</strong></p><p name="c79d" id="c79d" class="graf graf--p graf-after--p">YOLO9000 extends YOLO to detect objects over 9000 classes using hierarchical classification with a 9418 node WordTree. It combines samples from COCO and the top 9000 classes from the ImageNet. YOLO samples four ImageNet data for every COCO data. It learns to find objects using the detection data in COCO and to classify these objects with ImageNet samples.</p><p name="4b01" id="4b01" class="graf graf--p graf-after--p">During the evaluation, YOLO test images on categories that it knows how to classify but not trained directly to locate them, i.e. categories that do not exist in COCO. YOLO9000 evaluates its result from the ImageNet object detection dataset which has 200 categories. It shares about 44 categories with COCO. Therefore, the dataset contains 156 categories that have never been trained directly on how to locate them. YOLO extracts similar features for related object types. Hence, we can detect those 156 categories by simply from the feature values.</p><p name="69d2" id="69d2" class="graf graf--p graf-after--p">YOLO9000 gets 19.7 mAP overall with 16.0 mAP on those 156 categories. YOLO9000 performs well with new species of animals not found in COCO because their shapes can be generalized easily from their parent classes. However, COCO does not have bounding box labels for any type of clothing so the test struggles with categories like “sunglasses”.</p><h3 name="b8ad" id="b8ad" class="graf graf--h3 graf-after--p">YOLOv3</h3><figure name="fd5c" id="fd5c" class="graf graf--figure graf--iframe graf-after--h3"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 56.2%;"></div><div class="progressiveMedia js-progressiveMedia"><img src="https://i.embed.ly/1/display/resize?url=https%3A%2F%2Fi.ytimg.com%2Fvi%2FMPU2HistivI%2Fhqdefault.jpg&amp;key=a19fcc184b9711e1b4764040d3dc5c07&amp;width=40" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><div class="iframeContainer"><IFRAME data-width="854" data-height="480" width="700" height="393" data-src="/media/28431402a61e5d8c00d4e6827e656b8b?postId=28b1b93e2088" data-media-id="28431402a61e5d8c00d4e6827e656b8b" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Fi.ytimg.com%2Fvi%2FMPU2HistivI%2Fhqdefault.jpg&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen frameborder="0"></IFRAME></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME data-width="854" data-height="480" width="700" height="393" src="/media/28431402a61e5d8c00d4e6827e656b8b?postId=28b1b93e2088" data-media-id="28431402a61e5d8c00d4e6827e656b8b" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Fi.ytimg.com%2Fvi%2FMPU2HistivI%2Fhqdefault.jpg&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><p name="9fad" id="9fad" class="graf graf--p graf-after--figure">A quote from the YOLO web site on YOLOv3:</p><blockquote name="974f" id="974f" class="graf graf--blockquote graf-after--p">On a Pascal Titan X it processes images at 30 FPS and has a mAP of 57.9% on COCO test-dev.</blockquote><p name="667f" id="667f" class="graf graf--p graf-after--blockquote"><strong class="markup--strong markup--p-strong">Class Prediction</strong></p><p name="7f2d" id="7f2d" class="graf graf--p graf-after--p">Most classifiers assume output labels are mutually exclusive. It is true if the output are mutually exclusive object classes. Therefore, YOLO applies a softmax function to convert scores into probabilities that sum up to one. YOLOv3 uses multi-label classification. For example, the output labels may be “pedestrian” and “child” which are not non-exclusive. (the sum of output can be greater than 1 now.) YOLOv3 replaces the softmax function with independent logistic classifiers to calculate the likeliness of the input belongs to a specific label. Instead of using mean square error in calculating the classification loss, YOLOv3 uses binary cross-entropy loss for each label. This also reduces the computation complexity by avoiding the softmax function.</p><p name="c898" id="c898" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Bounding box prediction &amp; cost function calculation</strong></p><p name="373a" id="373a" class="graf graf--p graf-after--p">YOLOv3 predicts an objectness score for each bounding box using logistic regression. YOLOv3 changes the way in calculating the cost function. If the bounding box prior (anchor) overlaps a ground truth object more than others, the corresponding objectness score should be 1. For other priors with overlap greater than a predefined threshold (default 0.5), they incur no cost. Each ground truth object is associated with one boundary box prior only. If a bounding box prior is not assigned, it incurs no classification and localization lost, just confidence loss on objectness. We use tx and ty (instead of bx and by) to compute the loss.</p><figure name="a75a" id="a75a" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 121px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 17.299999999999997%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*UuIx6sH39tefFMxgWAaaNQ.png" data-width="1040" data-height="180" data-action="zoom" data-action-value="1*UuIx6sH39tefFMxgWAaaNQ.png"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*UuIx6sH39tefFMxgWAaaNQ.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*UuIx6sH39tefFMxgWAaaNQ.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*UuIx6sH39tefFMxgWAaaNQ.png"></noscript></div></div></figure><p name="6b02" id="6b02" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Feature Pyramid Networks (FPN) like Feature Pyramid</strong></p><p name="b55f" id="b55f" class="graf graf--p graf-after--p">YOLOv3 makes 3 predictions per location. Each prediction composes of a boundary box, a objectness and 80 class scores, i.e. N × N × [3 × (4 + 1 + 80) ] predictions.</p><p name="c2ae" id="c2ae" class="graf graf--p graf-after--p">YOLOv3 makes predictions at 3 different scales (similar to the FPN):</p><ol class="postList"><li name="403a" id="403a" class="graf graf--li graf-after--p">In the last feature map layer.</li><li name="6ecf" id="6ecf" class="graf graf--li graf-after--li">Then it goes back 2 layers back and upsamples it by 2. YOLOv3 then takes a feature map with higher resolution and merge it with the upsampled feature map using element-wise addition. YOLOv3 apply convolutional filters on the merged map to make the second set of predictions.</li><li name="7b3e" id="7b3e" class="graf graf--li graf-after--li">Repeat 2 again so the resulted feature map layer has good high-level structure (semantic) information and good resolution spatial information on object locations.</li></ol><p name="ecae" id="ecae" class="graf graf--p graf-after--li">To determine the priors, YOLOv3 applies k-means cluster. Then it pre-select 9 clusters. For COCO, the width and height of the anchors are (10×13),(16×30),(33×23),(30×61),(62×45),(59× 119),(116 × 90),(156 × 198),(373 × 326). These 9 priors are grouped into 3 different groups according to their scale. Each group is assigned to a specific feature map above in detecting objects.</p><p name="4161" id="4161" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Feature extractor</strong></p><p name="f03d" id="f03d" class="graf graf--p graf-after--p">A new 53-layer Darknet-53 is used to replace the Darknet-19 as the feature extractor. Darknet-53 mainly compose of 3 × 3 and 1× 1 filters with skip connections like the residual network in ResNet. Darknet-53 has less BFLOP (billion floating point operations) than ResNet-152, but achieves the same classification accuracy at 2x faster.</p><figure name="9603" id="9603" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 334px; max-height: 462px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 138.3%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*biRYJyCSv-UTbTQTa4Afqg.png" data-width="334" data-height="462"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*biRYJyCSv-UTbTQTa4Afqg.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*biRYJyCSv-UTbTQTa4Afqg.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*biRYJyCSv-UTbTQTa4Afqg.png"></noscript></div></div><figcaption class="imageCaption"><a href="https://pjreddie.com/media/files/papers/YOLOv3.pdf" data-href="https://pjreddie.com/media/files/papers/YOLOv3.pdf" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">Darknet-53</a></figcaption></figure><p name="def0" id="def0" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">YOLOv3 performance</strong></p><p name="20af" id="20af" class="graf graf--p graf-after--p">YOLOv3&#39;s COCO AP metric is on par with SSD but 3x faster. But YOLOv3’s AP is still behind RetinaNet. In particular, AP@IoU=.75 drops significantly comparing with RetinaNet which suggests YOLOv3 has higher localization error. YOLOv3 also shows significant improvement in detecting small objects.</p></div><div class="section-inner sectionLayout--outsetColumn"><figure name="5cda" id="5cda" class="graf graf--figure graf--layoutOutsetCenter graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1028px; max-height: 290px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 28.199999999999996%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*bFMwN__ZgfvVRYuo4o8EEg.png" data-width="1028" data-height="290"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*bFMwN__ZgfvVRYuo4o8EEg.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1800/1*bFMwN__ZgfvVRYuo4o8EEg.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1800/1*bFMwN__ZgfvVRYuo4o8EEg.png"></noscript></div></div></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="148d" id="148d" class="graf graf--p graf-after--figure">YOLOv3 performs very well in the fast detector category when speed is important.</p><figure name="27e3" id="27e3" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 436px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 62.3%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*RFpjH8D6TStBaYuZYehe_g.png" data-width="1328" data-height="828" data-action="zoom" data-action-value="1*RFpjH8D6TStBaYuZYehe_g.png"><img src="https://cdn-images-1.medium.com/freeze/max/45/1*RFpjH8D6TStBaYuZYehe_g.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*RFpjH8D6TStBaYuZYehe_g.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*RFpjH8D6TStBaYuZYehe_g.png"></noscript></div></div><figcaption class="imageCaption"><a href="https://pjreddie.com/media/files/papers/YOLOv3.pdf" data-href="https://pjreddie.com/media/files/papers/YOLOv3.pdf" class="markup--anchor markup--figure-anchor" rel="noopener nofollow" target="_blank">Source</a></figcaption></figure><h3 name="3054" id="3054" class="graf graf--h3 graf-after--figure">Resources</h3><p name="e094" id="e094" class="graf graf--p graf-after--h3"><a href="https://arxiv.org/pdf/1506.02640.pdf" data-href="https://arxiv.org/pdf/1506.02640.pdf" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">The original paper on YOLO.</a></p><p name="7b35" id="7b35" class="graf graf--p graf-after--p"><a href="https://arxiv.org/pdf/1612.08242.pdf" data-href="https://arxiv.org/pdf/1612.08242.pdf" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Paper on YOLOv2 and YOLO9000.</a></p><p name="fac5" id="fac5" class="graf graf--p graf-after--p graf--trailing"><a href="https://github.com/pjreddie/darknet" data-href="https://github.com/pjreddie/darknet" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">DarkNet implementation.</a></p></div></div></section></div><footer class="u-paddingTop10"><div class="container u-maxWidth740"><div class="row"><div class="col u-size12of12"></div></div><div class="row"><div class="col u-size12of12 js-postTags"><div class="u-paddingBottom10"><ul class="tags tags--postTags tags--borderless"><li><a class="link u-baseColor--link"   href="https://medium.com/tag/machine-learning?source=post" data-action-source="post">Machine Learning</a></li><li><a class="link u-baseColor--link"   href="https://medium.com/tag/deep-learning?source=post" data-action-source="post">Deep Learning</a></li><li><a class="link u-baseColor--link"   href="https://medium.com/tag/computer-vision?source=post" data-action-source="post">Computer Vision</a></li><li><a class="link u-baseColor--link"   href="https://medium.com/tag/artificial-intelligence?source=post" data-action-source="post">Artificial Intelligence</a></li></ul></div></div></div><div class="postActions js-postActionsFooter "><div class="u-flexCenter"><div class="u-flex1"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="28b1b93e2088" data-is-icon-29px="true" data-is-circle="true" data-has-recommend-list="true" data-source="post_actions_footer-----28b1b93e2088---------------------clap_footer" data-clap-string-singular="clap" data-clap-string-plural="claps"><div class="u-relative u-foreground"><button class="button button--large button--circle button--withChrome u-baseColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker clapButton--largePill u-relative u-foreground u-xs-paddingLeft13 u-width60 u-height60 u-accentColor--textNormal u-accentColor--buttonNormal clap-onboarding"  data-action="multivote" data-action-value="28b1b93e2088" data-action-type="long-press" data-action-source="post_actions_footer-----28b1b93e2088---------------------clap_footer" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" ><path d="M28.86 17.342l-3.64-6.402c-.292-.433-.712-.729-1.163-.8a1.124 1.124 0 0 0-.889.213c-.63.488-.742 1.181-.33 2.061l1.222 2.587 1.4 2.46c2.234 4.085 1.511 8.007-2.145 11.663-.26.26-.526.49-.797.707 1.42-.084 2.881-.683 4.292-2.094 3.822-3.823 3.565-7.876 2.05-10.395zm-6.252 11.075c3.352-3.35 3.998-6.775 1.978-10.469l-3.378-5.945c-.292-.432-.712-.728-1.163-.8a1.122 1.122 0 0 0-.89.213c-.63.49-.742 1.182-.33 2.061l1.72 3.638a.502.502 0 0 1-.806.568l-8.91-8.91a1.335 1.335 0 0 0-1.887 1.886l5.292 5.292a.5.5 0 0 1-.707.707l-5.292-5.292-1.492-1.492c-.503-.503-1.382-.505-1.887 0a1.337 1.337 0 0 0 0 1.886l1.493 1.492 5.292 5.292a.499.499 0 0 1-.353.854.5.5 0 0 1-.354-.147L5.642 13.96a1.338 1.338 0 0 0-1.887 0 1.338 1.338 0 0 0 0 1.887l2.23 2.228 3.322 3.324a.499.499 0 0 1-.353.853.502.502 0 0 1-.354-.146l-3.323-3.324a1.333 1.333 0 0 0-1.886 0 1.325 1.325 0 0 0-.39.943c0 .356.138.691.39.943l6.396 6.397c3.528 3.53 8.86 5.313 12.821 1.353zM12.73 9.26l5.68 5.68-.49-1.037c-.518-1.107-.426-2.13.224-2.89l-3.303-3.304a1.337 1.337 0 0 0-1.886 0 1.326 1.326 0 0 0-.39.944c0 .217.067.42.165.607zm14.787 19.184c-1.599 1.6-3.417 2.392-5.353 2.392-.349 0-.7-.03-1.058-.082a7.922 7.922 0 0 1-3.667.887c-3.049 0-6.115-1.626-8.359-3.87l-6.396-6.397A2.315 2.315 0 0 1 2 19.724a2.327 2.327 0 0 1 1.923-2.296l-.875-.875a2.339 2.339 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.647l-.139-.139c-.91-.91-.91-2.39 0-3.3.884-.884 2.421-.882 3.301 0l.138.14a2.335 2.335 0 0 1 3.948-1.24l.093.092c.091-.423.291-.828.62-1.157a2.336 2.336 0 0 1 3.3 0l3.384 3.386a2.167 2.167 0 0 1 1.271-.173c.534.086 1.03.354 1.441.765.11-.549.415-1.034.911-1.418a2.12 2.12 0 0 1 1.661-.41c.727.117 1.385.565 1.853 1.262l3.652 6.423c1.704 2.832 2.025 7.377-2.205 11.607zM13.217.484l-1.917.882 2.37 2.837-.454-3.719zm8.487.877l-1.928-.86-.44 3.697 2.368-2.837zM16.5 3.293L15.478-.005h2.044L16.5 3.293z" fill-rule="evenodd"/></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" ><g fill-rule="evenodd"><path d="M29.58 17.1l-3.854-6.78c-.365-.543-.876-.899-1.431-.989a1.491 1.491 0 0 0-1.16.281c-.42.327-.65.736-.7 1.207v.001l3.623 6.367c2.46 4.498 1.67 8.802-2.333 12.807-.265.265-.536.505-.81.728 1.973-.222 3.474-1.286 4.45-2.263 4.166-4.165 3.875-8.6 2.215-11.36zm-4.831.82l-3.581-6.3c-.296-.439-.725-.742-1.183-.815a1.105 1.105 0 0 0-.89.213c-.647.502-.755 1.188-.33 2.098l1.825 3.858a.601.601 0 0 1-.197.747.596.596 0 0 1-.77-.067L10.178 8.21c-.508-.506-1.393-.506-1.901 0a1.335 1.335 0 0 0-.393.95c0 .36.139.698.393.95v.001l5.61 5.61a.599.599 0 1 1-.848.847l-5.606-5.606c-.001 0-.002 0-.003-.002L5.848 9.375a1.349 1.349 0 0 0-1.902 0 1.348 1.348 0 0 0 0 1.901l1.582 1.582 5.61 5.61a.6.6 0 0 1-.848.848l-5.61-5.61c-.51-.508-1.393-.508-1.9 0a1.332 1.332 0 0 0-.394.95c0 .36.139.697.393.952l2.363 2.362c.002.001.002.002.002.003l3.52 3.52a.6.6 0 0 1-.848.847l-3.522-3.523h-.001a1.336 1.336 0 0 0-.95-.393 1.345 1.345 0 0 0-.949 2.295l6.779 6.78c3.715 3.713 9.327 5.598 13.49 1.434 3.527-3.528 4.21-7.13 2.086-11.015zM11.817 7.727c.06-.328.213-.64.466-.893.64-.64 1.755-.64 2.396 0l3.232 3.232c-.82.783-1.09 1.833-.764 2.992l-5.33-5.33z"/><path d="M13.285.48l-1.916.881 2.37 2.837z"/><path d="M21.719 1.361L19.79.501l-.44 3.697z"/><path d="M16.502 3.298L15.481 0h2.043z"/></g></svg></span></span></button><div class="clapUndo u-width60 u-round u-height32 u-absolute u-borderBox u-paddingRight5 u-transition--transform200Springu-backgroundGrayLighter js-clapUndo" style="top: 14px; padding: 2px;"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-floatRight"  data-action="multivote-undo" data-action-value="28b1b93e2088"><span class="svgIcon svgIcon--removeThin svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M20.13 8.11l-5.61 5.61-5.609-5.61-.801.801 5.61 5.61-5.61 5.61.801.8 5.61-5.609 5.61 5.61.8-.801-5.609-5.61 5.61-5.61" fill-rule="evenodd"/></svg></span></button></div></div><span class="u-relative u-background js-actionMultirecommendCount u-marginLeft16"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-textColorDarker"  data-action="show-recommends" data-action-value="28b1b93e2088">4.2K claps</button><span class="u-xs-hide"><div class="postMetaInline">Applause from <a class="link link--darken u-accentColor--textDarken u-baseColor--link"   href="https://medium.com/@parkchansung" data-action="show-user-card" data-action-value="33eb7bedce13" data-action-type="hover" data-user-id="33eb7bedce13" dir="auto">Park Chansung</a> <span class="u-noWrap">and <button class="button button--chromeless u-baseColor--buttonNormal"  data-action="show-recommends" data-action-value="28b1b93e2088">608 others</button></span></div></span></span></div></div><div class="buttonSet u-flex0"><a class="button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless u-xs-hide u-marginRight12"   href="https://medium.com/p/28b1b93e2088/share/twitter" title="Share on Twitter" aria-label="Share on Twitter" target="_blank" data-action-source="post_actions_footer"><span class="button-defaultState"><span class="svgIcon svgIcon--twitterFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M22.053 7.54a4.474 4.474 0 0 0-3.31-1.455 4.526 4.526 0 0 0-4.526 4.524c0 .35.04.7.082 1.05a12.9 12.9 0 0 1-9.3-4.77c-.39.69-.61 1.46-.65 2.26.03 1.6.83 2.99 2.02 3.79-.72-.02-1.41-.22-2.02-.57-.01.02-.01.04 0 .08-.01 2.17 1.55 4 3.63 4.44-.39.08-.79.13-1.21.16-.28-.03-.57-.05-.81-.08.54 1.77 2.21 3.08 4.2 3.15a9.564 9.564 0 0 1-5.66 1.94c-.34-.03-.7-.06-1.05-.08 2 1.27 4.38 2.02 6.94 2.02 8.31 0 12.86-6.9 12.84-12.85.02-.24.01-.43 0-.65.89-.62 1.65-1.42 2.26-2.34-.82.38-1.69.62-2.59.72a4.37 4.37 0 0 0 1.94-2.51c-.84.53-1.81.9-2.83 1.13z"/></svg></span></span></a><a class="button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless u-xs-hide u-marginRight12"   href="https://medium.com/p/28b1b93e2088/share/facebook" title="Share on Facebook" aria-label="Share on Facebook" target="_blank" data-action-source="post_actions_footer"><span class="button-defaultState"><span class="svgIcon svgIcon--facebookSquare svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M23.209 5H5.792A.792.792 0 0 0 5 5.791V23.21c0 .437.354.791.792.791h9.303v-7.125H12.72v-2.968h2.375v-2.375c0-2.455 1.553-3.662 3.741-3.662 1.049 0 1.95.078 2.213.112v2.565h-1.517c-1.192 0-1.469.567-1.469 1.397v1.963h2.969l-.594 2.968h-2.375L18.11 24h5.099a.791.791 0 0 0 .791-.791V5.79a.791.791 0 0 0-.791-.79"/></svg></span></span></a><button class="button button--large button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-show u-marginRight10"  title="Share this story on Twitter or Facebook" aria-label="Share this story on Twitter or Facebook" data-action="show-share-popover" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--share svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M20.385 8H19a.5.5 0 1 0 .011 1h1.39c.43 0 .84.168 1.14.473.31.305.48.71.48 1.142v10.77c0 .43-.17.837-.47 1.142-.3.305-.71.473-1.14.473H8.62c-.43 0-.84-.168-1.144-.473a1.603 1.603 0 0 1-.473-1.142v-10.77c0-.43.17-.837.48-1.142A1.599 1.599 0 0 1 8.62 9H10a.502.502 0 0 0 0-1H8.615c-.67 0-1.338.255-1.85.766-.51.51-.765 1.18-.765 1.85v10.77c0 .668.255 1.337.766 1.848.51.51 1.18.766 1.85.766h11.77c.668 0 1.337-.255 1.848-.766.51-.51.766-1.18.766-1.85v-10.77c0-.668-.255-1.337-.766-1.848A2.61 2.61 0 0 0 20.384 8zm-8.67-2.508L14 3.207v8.362c0 .27.224.5.5.5s.5-.23.5-.5V3.2l2.285 2.285a.49.49 0 0 0 .704-.001.511.511 0 0 0 0-.708l-3.14-3.14a.504.504 0 0 0-.71 0L11 4.776a.501.501 0 0 0 .71.706" fill-rule="evenodd"/></svg></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon"  data-action="respond" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--response svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"/></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal u-marginRight12"  data-action="scroll-to-responses">48</button><button class="button button--large button--dark button--chromeless is-touchIconFadeInPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton"  title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="add-to-bookmarks" data-action-value="28b1b93e2088" data-action-source="post_actions_footer"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--29px u-marginRight4"><svg class="svgIcon-use" width="29" height="29" ><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z" fill-rule="evenodd"/></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--29px u-marginRight4"><svg class="svgIcon-use" width="29" height="29" ><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z" fill-rule="evenodd"/></svg></span></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon js-moreActionsButton"  title="More actions" aria-label="More actions" data-action="more-actions"><span class="svgIcon svgIcon--more svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"  viewBox="-480.5 272.5 21 21"><path d="M-463 284.6c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5z"/></svg></span></button></div></div></div></div><div class="u-maxWidth740 u-paddingTop20 u-marginTop20 u-borderTopLightest container u-paddingBottom20 u-xs-paddingBottom10 js-postAttributionFooterContainer"><div class="row js-postFooterInfo"><div class="col u-size12of12"><li class="uiScale uiScale-ui--small uiScale-caption--regular u-block u-paddingBottom18 js-cardUser"><div class="u-marginLeft20 u-floatRight"><span class="followState js-followState" data-user-id="bd51f1a63813"><button class="button button--small u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton"  data-action="toggle-block-user" data-action-value="bd51f1a63813" data-action-source="footer_card"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary button--small is-active u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton"  data-action="toggle-subscribe-user" data-action-value="bd51f1a63813" data-action-source="footer_card-bd51f1a63813-------------------------follow_footer" data-subscribe-source="footer_card" data-follow-context-entity-id="28b1b93e2088"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="u-tableCell"><a class="link u-baseColor--link avatar"   href="https://medium.com/@jonathan_hui?source=footer_card" title="Go to the profile of Jonathan Hui" aria-label="Go to the profile of Jonathan Hui" data-action-source="footer_card" data-user-id="bd51f1a63813" dir="auto"><img  src="https://cdn-images-1.medium.com/fit/c/90/90/1*c3Z3aOPBooxEX4tx4RkzLw.jpeg" class="avatar-image avatar-image--small" alt="Go to the profile of Jonathan Hui"></a></div><div class="u-tableCell u-verticalAlignMiddle u-breakWord u-paddingLeft15"><h3 class="ui-h3 u-fontSize18 u-lineHeightTighter u-marginBottom4"><a class="link link--primary u-accentColor--hoverTextNormal"   href="https://medium.com/@jonathan_hui" property="cc:attributionName" title="Go to the profile of Jonathan Hui" aria-label="Go to the profile of Jonathan Hui" rel="author cc:attributionUrl" data-user-id="bd51f1a63813" dir="auto">Jonathan Hui</a></h3><p class="ui-body u-fontSize14 u-lineHeightBaseSans u-textColorDark u-marginBottom4">Deep Learning</p></div></li></div></div></div><div class="js-postFooterPlacements" data-post-id="28b1b93e2088"></div><div class="u-padding0 u-clearfix u-backgroundGrayLightest u-print-hide supplementalPostContent js-responsesWrapper"></div><div class="supplementalPostContent js-heroPromo"></div></footer></article></main><aside class="u-marginAuto u-maxWidth1032 js-postLeftSidebar"><div class="u-foreground u-top0 u-transition--fadeOut300 u-fixed u-sm-hide js-postShareWidget"><ul><li class="u-marginVertical10"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="28b1b93e2088" data-is-icon-29px="true" data-has-recommend-list="true" data-source="post_share_widget-----28b1b93e2088---------------------clap_sidebar"><div class="u-relative u-foreground"><button class="button button--primary button--large button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker"  data-action="multivote" data-action-value="28b1b93e2088" data-action-type="long-press" data-action-source="post_share_widget-----28b1b93e2088---------------------clap_sidebar" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><g fill-rule="evenodd"><path d="M13.739 1l.761 2.966L15.261 1z"/><path d="M16.815 4.776l1.84-2.551-1.43-.471z"/><path d="M10.378 2.224l1.84 2.551-.408-3.022z"/><path d="M22.382 22.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L6.11 15.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L8.43 9.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L20.628 15c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM12.99 6.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"/></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><g fill-rule="evenodd"><path d="M13.738 1l.762 2.966L15.262 1z"/><path d="M18.634 2.224l-1.432-.47-.408 3.022z"/><path d="M11.79 1.754l-1.431.47 1.84 2.552z"/><path d="M24.472 14.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"/><path d="M14.58 10.887c-.156-.83.096-1.569.692-2.142L12.78 6.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"/><path d="M17.812 10.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L9.2 7.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L7.046 9.54 5.802 8.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394l1.241 1.241 4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L4.89 11.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C21.74 20.8 22.271 18 20.62 14.982l-2.809-4.942z"/></g></svg></span></span></button></div><span class="u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton"  data-action="show-recommends" data-action-value="28b1b93e2088">4.2K</button></span></div></li><li class="u-marginVertical10 u-marginLeft3"><button class="button button--large button--dark button--chromeless is-touchIconFadeInPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton"  title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="add-to-bookmarks" data-action-value="28b1b93e2088" data-action-source="post_share_widget-----28b1b93e2088---------------------bookmark_sidebar"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z" fill-rule="evenodd"/></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z" fill-rule="evenodd"/></svg></span></span></button></li><li class="u-marginVertical10 u-marginLeft3"><a class="button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless"   href="https://medium.com/p/28b1b93e2088/share/twitter" title="Share on Twitter" aria-label="Share on Twitter" target="_blank" data-action-source="post_share_widget"><span class="button-defaultState"><span class="svgIcon svgIcon--twitterFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M22.053 7.54a4.474 4.474 0 0 0-3.31-1.455 4.526 4.526 0 0 0-4.526 4.524c0 .35.04.7.082 1.05a12.9 12.9 0 0 1-9.3-4.77c-.39.69-.61 1.46-.65 2.26.03 1.6.83 2.99 2.02 3.79-.72-.02-1.41-.22-2.02-.57-.01.02-.01.04 0 .08-.01 2.17 1.55 4 3.63 4.44-.39.08-.79.13-1.21.16-.28-.03-.57-.05-.81-.08.54 1.77 2.21 3.08 4.2 3.15a9.564 9.564 0 0 1-5.66 1.94c-.34-.03-.7-.06-1.05-.08 2 1.27 4.38 2.02 6.94 2.02 8.31 0 12.86-6.9 12.84-12.85.02-.24.01-.43 0-.65.89-.62 1.65-1.42 2.26-2.34-.82.38-1.69.62-2.59.72a4.37 4.37 0 0 0 1.94-2.51c-.84.53-1.81.9-2.83 1.13z"/></svg></span></span></a></li><li class="u-marginVertical10 u-marginLeft3"><a class="button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless"   href="https://medium.com/p/28b1b93e2088/share/facebook" title="Share on Facebook" aria-label="Share on Facebook" target="_blank" data-action-source="post_share_widget"><span class="button-defaultState"><span class="svgIcon svgIcon--facebookSquare svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M23.209 5H5.792A.792.792 0 0 0 5 5.791V23.21c0 .437.354.791.792.791h9.303v-7.125H12.72v-2.968h2.375v-2.375c0-2.455 1.553-3.662 3.741-3.662 1.049 0 1.95.078 2.213.112v2.565h-1.517c-1.192 0-1.469.567-1.469 1.397v1.963h2.969l-.594 2.968h-2.375L18.11 24h5.099a.791.791 0 0 0 .791-.791V5.79a.791.791 0 0 0-.791-.79"/></svg></span></span></a></li></ul></div></aside></div></div></div><div class="loadingBar"></div><script>// <![CDATA[
window["obvInit"] = function (opt_embedded) {window["obvInit"]["embedded"] = opt_embedded; window["obvInit"]["ready"] = true;}
// ]]></script><script>// <![CDATA[
var GLOBALS = {"audioUrl":"https://d1fcbxp97j4nb2.cloudfront.net","baseUrl":"https://medium.com","buildLabel":"37043","currentUser":{"userId":"381bf2a1ecff","username":"u6yuvi","name":"UTKARSH VARDHAN","email":"u6yuvi@gmail.com","imageId":"0*Vn6DLUxkc4s-ryDf.","createdAt":1503644888925,"lastPostCreatedAt":1549347961908,"isVerified":true,"subscriberEmail":"","onboardingStatus":3,"googleAccountId":"115322313334274426437","googleEmail":"u6yuvi@gmail.com","hasPastMemberships":false,"isEnrolledInHightower":false,"isEligibleForHightower":true,"hightowerLastLockedAt":0,"isWriterProgramEnrolled":true,"isWriterProgramInvited":true,"isWriterProgramOptedOut":false,"writerProgramVersion":4,"writerProgramEnrolledAt":1551479033074,"friendLinkOnboarding":0,"hasAdditionalUnlocks":false,"hasApiAccess":false,"isQuarantined":false,"writerProgramDistributionSettingOptedIn":false},"currentUserHasUnverifiedEmail":false,"isAuthenticated":true,"isCurrentUserVerified":true,"language":"en-us","miroUrl":"https://cdn-images-1.medium.com","moduleUrls":{"base":"https://cdn-static-1.medium.com/_/fp/gen-js/main-base.bundle.Pe1dCaZz5Z8TqHEqAnKebg.js","common-async":"https://cdn-static-1.medium.com/_/fp/gen-js/main-common-async.bundle.5QThpcDhNu1v0yWykA0MVQ.js","hightower":"https://cdn-static-1.medium.com/_/fp/gen-js/main-hightower.bundle.nkOHfyKu6IglBNnDXiDkjg.js","home-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-home-screens.bundle.0ZFKF8t5A8dX97-dzSjJPQ.js","misc-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-misc-screens.bundle.bvG6W9_9e4ixalSmv30BQw.js","notes":"https://cdn-static-1.medium.com/_/fp/gen-js/main-notes.bundle.Q4cjIyQbrpXYDOgLRcCgTQ.js","payments":"https://cdn-static-1.medium.com/_/fp/gen-js/main-payments.bundle.yRKhyByRLOGwaUB5Ri7gJw.js","posters":"https://cdn-static-1.medium.com/_/fp/gen-js/main-posters.bundle.chUqoYhpHShNhSjBamvyeA.js","power-readers":"https://cdn-static-1.medium.com/_/fp/gen-js/main-power-readers.bundle.fAPf175pnTbBD9B1R4PWnA.js","pubs":"https://cdn-static-1.medium.com/_/fp/gen-js/main-pubs.bundle.ceNKnzTLVuFSMn7gNaohYA.js","stats":"https://cdn-static-1.medium.com/_/fp/gen-js/main-stats.bundle.JAFLzuiS2HQGAAuqKu-i4w.js"},"previewConfig":{"weightThreshold":1,"weightImageParagraph":0.51,"weightIframeParagraph":0.8,"weightTextParagraph":0.08,"weightEmptyParagraph":0,"weightP":0.003,"weightH":0.005,"weightBq":0.003,"minPTextLength":60,"truncateBoundaryChars":20,"detectTitle":true,"detectTitleLevThreshold":0.15},"productName":"Medium","supportsEdit":true,"termsUrl":"//medium.com/policy/9db0094a1e0f","textshotHost":"textshot.medium.com","transactionId":"1553852883974:c41200219311","useragent":{"browser":"chrome","family":"chrome","os":"windows","version":72,"supportsDesktopEdit":true,"supportsInteract":true,"supportsView":true,"isMobile":false,"isTablet":false,"isNative":false,"supportsFileAPI":true,"isTier1":true,"clientVersion":"","unknownParagraphsBad":false,"clientChannel":"","supportsRealScrollEvents":true,"supportsVhUnits":true,"ruinsViewportSections":false,"supportsHtml5Video":true,"supportsMagicUnderlines":true,"isWebView":false,"isFacebookWebView":false,"supportsProgressiveMedia":true,"supportsPromotedPosts":true,"isBot":false,"isNativeIphone":false,"supportsCssVariables":true,"supportsVideoSections":true,"emojiSupportLevel":1,"isSearchBot":false,"isSyndicationBot":false,"isNativeAndroid":false,"supportsScrollableMetabar":true},"variants":{"allow_access":true,"allow_signup":true,"allow_test_auth":"disallow","signin_services":"twitter,facebook,google,email,google-fastidv,google-one-tap","signup_services":"twitter,facebook,google,email,google-fastidv,google-one-tap","google_sign_in_android":true,"reengagement_notification_duration":3,"browsable_stream_config_bucket":"curated-topics","enable_dedicated_series_tab_api_ios":true,"enable_post_import":true,"available_monthly_plan":"60e220181034","available_annual_plan":"2c754bcc2995","disable_ios_resume_reading_toast":true,"is_not_medium_subscriber":true,"glyph_font_set":"m2","enable_branding":true,"enable_branding_fonts":true,"enable_2019_march_meter_limit_update":true,"max_premium_content_per_user_under_metering":3,"enable_automated_mission_control_triggers":true,"enable_lite_profile":true,"enable_marketing_emails":true,"enable_topic_lifecycle_email":true,"enable_parsely":true,"enable_branch_io":true,"enable_ios_post_stats":true,"enable_lite_topics":true,"enable_lite_stories":true,"redis_read_write_splitting":true,"enable_tipalti_onboarding":true,"enable_annual_renewal_reminder_email":true,"enable_janky_spam_rules":"users,posts","enable_new_collaborative_filtering_data":true,"android_rating_prompt_stories_read_threshold":2,"enable_smart_meter_with_incentive":true,"stripe_v3":true,"enable_google_one_tap":true,"enable_email_sign_in_captcha":true,"enable_rito_sequence_post_recirc_query":true,"enable_primary_topic_for_mobile":true,"enable_prereg_post_post_recs":true,"enable_rito_sequence_post_handler":true,"enable_interest_graph_with_signup_post":true,"enable_todays_highlights_android":true,"enable_improved_stats_curation_status":true,"enable_logged_out_homepage_signup":true,"enable_direct_email_signup_endpoint":true,"use_new_admin_topic_backend":true,"enable_full_name_screen_refresh":true,"enable_quarantine_rules":true,"enable_lite_privacy_banner":true,"enable_follow_topics_directly_from_nonboarded_welcome_email":true,"enable_redirect_to_homepage_after_onboarding":true},"xsrfToken":"XNqAy2W1p37U","iosAppId":"828256236","supportEmail":"yourfriends@medium.com","fp":{"/icons/monogram-mask.svg":"https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg","/icons/favicon-dev-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-dev-editor.YKKRxBO8EMvIqhyCwIiJeQ.ico","/icons/favicon-hatch-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-hatch-editor.BuEyHIqlyh2s_XEk4Rl32Q.ico","/icons/favicon-medium-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-medium-editor.PiakrZWB7Yb80quUVQWM6g.ico"},"authBaseUrl":"https://medium.com","imageUploadSizeMb":25,"isAuthDomainRequest":true,"algoliaApiEndpoint":"https://MQ57UUUQZ2-dsn.algolia.net","algoliaAppId":"MQ57UUUQZ2","algoliaSearchOnlyApiKey":"394474ced050e3911ae2249ecc774921","iosAppStoreUrl":"https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8","iosAppLinkBaseUrl":"medium:","algoliaIndexPrefix":"medium_","androidPlayStoreUrl":"https://play.google.com/store/apps/details?id=com.medium.reader","googleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","androidPackage":"com.medium.reader","androidPlayStoreMarketScheme":"market://details?id=com.medium.reader","googleAuthUri":"https://accounts.google.com/o/oauth2/auth","androidScheme":"medium","layoutData":{"useDynamicScripts":false,"googleAnalyticsTrackingCode":"UA-24232453-2","jsShivUrl":"https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js","useDynamicCss":false,"faviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico","faviconImageId":"1*8I-HPL0bfoIzGied-dzOvA.png","fontSets":[{"id":8,"url":"https://glyph.medium.com/css/e/sr/latin/e/ssr/latin/e/ssb/latin/m2.css"},{"id":11,"url":"https://glyph.medium.com/css/m2.css"},{"id":9,"url":"https://glyph.medium.com/css/mkt.css"}],"editorFaviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium-editor.3Y6xpZ-0FSdWDnPM3hSBIA.ico","glyphUrl":"https://glyph.medium.com"},"authBaseUrlRev":"moc.muidem//:sptth","isDnt":false,"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","archiveUploadSizeMb":100,"paymentData":{"currencies":{"1":{"label":"US Dollar","external":"usd"}},"countries":{"1":{"label":"United States of America","external":"US"}},"accountTypes":{"1":{"label":"Individual","external":"individual"},"2":{"label":"Company","external":"company"}}},"previewConfig2":{"weightThreshold":1,"weightImageParagraph":0.05,"raiseImage":true,"enforceHeaderHierarchy":true,"isImageInsetRight":true},"isAmp":false,"iosScheme":"medium","isSwBoot":false,"lightstep":{"accessToken":"ce5be895bef60919541332990ac9fef2","carrier":"{\"ot-tracer-spanid\":\"62d60fc860019aa3\",\"ot-tracer-traceid\":\"2e7fdc3656667633\",\"ot-tracer-sampled\":\"true\"}","host":"collector-medium.lightstep.com"},"facebook":{"key":"542599432471018","namespace":"medium-com","scope":{"default":["public_profile","email"],"connect":["public_profile","email"],"login":["public_profile","email"],"share":["public_profile","email"]}},"editorsPicksTopicId":"3985d2a191c5","popularOnMediumTopicId":"9d34e48ecf94","memberContentTopicId":"13d7efd82fb2","audioContentTopicId":"3792abbd134","brandedSequenceId":"7d337ddf1941","isDoNotAuth":false,"goldfinchUrl":"https://goldfinch.medium.com","buggle":{"url":"https://buggle.medium.com","videoUrl":"https://cdn-videos-1.medium.com","audioUrl":"https://cdn-audio-1.medium.com"},"referrerType":2,"isMeteredOut":false,"meterConfig":{"maxUnlockCount":5,"windowLength":"MONTHLY"},"partnerProgramEmail":"partnerprogram@medium.com","userResearchPrompts":[{"promptId":"li_post_page","type":0,"url":"www.calendly.com"},{"promptId":"li_home_page","type":1,"url":"mediumuserfeedback.typeform.com/to/GcFjEO"},{"promptId":"li_profile_page","type":2,"url":"www.calendly.com"}],"recaptchaKey":"6LdAokEUAAAAAC7seICd4vtC8chDb3jIXDQulyUJ","signinWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"countryCode":"IN","bypassMeter":false,"branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","paypal":{"clientMode":"production","oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com/redeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"}},"collectionConfig":{"mediumOwnedAndOperatedCollectionIds":["544c7006046e // Human Parts","bcc38c8f6edf // Matter","444d13b52878 // OneZero"]}}
// ]]></script><script charset="UTF-8" src="https://cdn-static-1.medium.com/_/fp/gen-js/main-base.bundle.Pe1dCaZz5Z8TqHEqAnKebg.js" async></script><script>// <![CDATA[
window["obvInit"]({"value":{"id":"28b1b93e2088","versionId":"c361a6e7ae85","creatorId":"bd51f1a63813","creator":{"userId":"bd51f1a63813","name":"Jonathan Hui","username":"jonathan_hui","createdAt":1518417490123,"imageId":"1*c3Z3aOPBooxEX4tx4RkzLw.jpeg","backgroundImageId":"","bio":"Deep Learning","twitterScreenName":"","socialStats":{"userId":"bd51f1a63813","usersFollowedCount":16,"usersFollowedByCount":6776,"type":"SocialStats"},"social":{"userId":"381bf2a1ecff","targetUserId":"bd51f1a63813","isFollowing":true,"isTwitterFollowing":false,"isFacebookFollowing":false,"isMediumFollowing":true,"type":"Social"},"facebookAccountId":"","allowNotes":1,"mediumMemberAt":0,"isNsfw":false,"isWriterProgramEnrolled":true,"isQuarantined":false,"type":"User"},"homeCollectionId":"","title":"Real-time Object Detection with YOLO, YOLOv2 and now YOLOv3","detectedLanguage":"en","latestVersion":"c361a6e7ae85","latestPublishedVersion":"c361a6e7ae85","hasUnpublishedEdits":false,"latestRev":9245,"createdAt":1520352489595,"updatedAt":1553719277642,"acceptedAt":0,"firstPublishedAt":1521338881687,"latestPublishedAt":1553719277642,"vote":false,"experimentalCss":"","displayAuthor":"","content":{"subtitle":"You only look once (YOLO) is an object detection system targeted for real-time processing. We will introduce YOLO, YOLOv2 and YOLO9000 in…","bodyModel":{"paragraphs":[{"name":"79c8","type":3,"text":"Real-time Object Detection with YOLO, YOLOv2 and now YOLOv3","markups":[]},{"name":"1749","type":1,"text":"You only look once (YOLO) is an object detection system targeted for real-time processing. We will introduce YOLO, YOLOv2 and YOLO9000 in this article. For those only interested in YOLOv3, please forward to the bottom of the article. Here is the accuracy and speed comparison provided by the YOLO web site.","markups":[{"type":3,"start":210,"end":232,"href":"https://medium.com/@jonathan_hui/real-time-object-detection-with-yolo-yolov2-28b1b93e2088#b8ad","title":"","rel":"","anchorType":0},{"type":1,"start":0,"end":25}]},{"name":"86c5","type":4,"text":"Source","markups":[{"type":3,"start":0,"end":6,"href":"https://pjreddie.com/darknet/yolo/","title":"","rel":"","anchorType":0}],"layout":1,"metadata":{"id":"1*ju1oaoIkVUkaIPAdpehlzA.png","originalWidth":1091,"originalHeight":960}},{"name":"e01c","type":1,"text":"A demonstration from the YOLOv2.","markups":[]},{"name":"da74","type":11,"text":"Object detection in real-time","markups":[],"layout":1,"iframe":{"mediaResourceId":"b901faec3876bb5da6091d9410fd9c72","iframeWidth":854,"iframeHeight":480,"thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Fi.ytimg.com%2Fvi%2FVOC3huqHrss%2Fhqdefault.jpg&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"ff6b","type":1,"text":"Let’s start with our own testing image below.","markups":[]},{"name":"c0e3","type":4,"text":"Testing image","markups":[{"type":1,"start":0,"end":13}],"layout":1,"metadata":{"id":"1*EYFejGUjvjPcc4PZTwoufw.jpeg","originalWidth":872,"originalHeight":586}},{"name":"acb9","type":1,"text":"The objects detected by YOLO:","markups":[]},{"name":"6b18","type":4,"text":"Objects detected by YOLO.","markups":[],"layout":1,"metadata":{"id":"1*QOGcvHbrDZiCqTG6THIQ_w.png","originalWidth":872,"originalHeight":586}},{"name":"4bc0","type":1,"text":"Grid cell","markups":[{"type":1,"start":0,"end":9}]},{"name":"65e3","type":1,"text":"For our discussion, we crop our original photo. YOLO divides the input image into an S×S grid. Each grid cell predicts only one object. For example, the yellow grid cell below tries to predict the “person” object whose center (the blue dot) falls inside the grid cell.","markups":[{"type":1,"start":85,"end":86},{"type":1,"start":87,"end":88},{"type":1,"start":124,"end":127}]},{"name":"f32c","type":4,"text":"Each grid cell detects only one object.","markups":[],"layout":1,"metadata":{"id":"1*6qZXYCDUkC5Bc8nRolT0Mw.jpeg","originalWidth":1139,"originalHeight":669}},{"name":"2220","type":1,"text":"Each grid cell predicts a fixed number of boundary boxes. In this example, the yellow grid cell makes two boundary box predictions (blue boxes) to locate where the person is.","markups":[]},{"name":"e9d1","type":4,"text":"Each grid cell make a fixed number of boundary box guesses for the object.","markups":[],"layout":1,"metadata":{"id":"1*4Y1PaY3ZgxKt5w84_0pNxw.jpeg","originalWidth":667,"originalHeight":669}},{"name":"779b","type":1,"text":"However, the one-object rule limits how close detected objects can be. For that, YOLO does have some limitations on how close objects can be. For the picture below, there are 9 Santas in the lower left corner but YOLO can detect 5 only.","markups":[]},{"name":"45e6","type":4,"text":"YOLO may miss objects that are too close.","markups":[],"layout":1,"metadata":{"id":"1*j4PnWfxP3yoVPOFyI27tww.jpeg","originalWidth":3036,"originalHeight":1855,"isFeatured":true}},{"name":"d9cf","type":1,"text":"For each grid cell,","markups":[]},{"name":"f040","type":9,"text":"it predicts B boundary boxes and each box has one box confidence score,","markups":[{"type":1,"start":12,"end":13},{"type":1,"start":50,"end":70}]},{"name":"23b9","type":9,"text":"it detects one object only regardless of the number of boxes B,","markups":[{"type":1,"start":11,"end":14}]},{"name":"4e9c","type":9,"text":"it predicts C conditional class probabilities (one per class for the likeliness of the object class).","markups":[{"type":1,"start":12,"end":13},{"type":1,"start":14,"end":45}]},{"name":"be90","type":1,"text":"To evaluate PASCAL VOC, YOLO uses 7×7 grids (S×S), 2 boundary boxes (B) and 20 classes (C).","markups":[]},{"name":"ce26","type":4,"text":"YOYO make SxS predictions with B boundary boxes.","markups":[],"layout":1,"metadata":{"id":"1*OuMJUWo2rXYA-GYU63NUGw.jpeg","originalWidth":2113,"originalHeight":1354}},{"name":"5ef3","type":1,"text":"Let’s get into more details. Each boundary box contains 5 elements: (x, y, w, h) and a box confidence score. The confidence score reflects how likely the box contains an object (objectness) and how accurate is the boundary box. We normalize the bounding box width w and height h by the image width and height. x and y are offsets to the corresponding cell. Hence, x, y, w and h are all between 0 and 1. Each cell has 20 conditional class probabilities. The conditional class probability is the probability that the detected object belongs to a particular class (one probability per category for each cell). So, YOLO’s prediction has a shape of (S, S, B×5 + C) = (7, 7, 2×5 + 20) = (7, 7, 30).","markups":[{"type":1,"start":87,"end":107},{"type":1,"start":178,"end":188},{"type":1,"start":457,"end":486},{"type":2,"start":69,"end":79},{"type":2,"start":264,"end":265},{"type":2,"start":277,"end":278},{"type":2,"start":310,"end":311},{"type":2,"start":316,"end":317},{"type":2,"start":364,"end":371},{"type":2,"start":376,"end":377}]},{"name":"8ad8","type":4,"text":"Source","markups":[{"type":3,"start":0,"end":6,"href":"https://arxiv.org/pdf/1506.02640.pdf","title":"","rel":"noopener","anchorType":0}],"layout":1,"metadata":{"id":"1*jtnrhMFNwGxiQmkY6LkdCQ.jpeg","originalWidth":804,"originalHeight":238}},{"name":"03d4","type":1,"text":"The major concept of YOLO is to build a CNN network to predict a (7, 7, 30) tensor. It uses a CNN network to reduce the spatial dimension to 7×7 with 1024 output channels at each location. YOLO performs a linear regression using two fully connected layers to make 7×7×2 boundary box predictions (the middle picture below). To make a final prediction, we keep those with high box confidence scores (greater than 0.25) as our final predictions (the right picture).","markups":[]},{"name":"dfc8","type":4,"text":"Source","markups":[{"type":3,"start":0,"end":6,"href":"https://pjreddie.com/darknet/yolo/","title":"","rel":"noopener","anchorType":0}],"layout":1,"metadata":{"id":"1*e0VY6U1_WMF2KBoKQNZvkQ.png","originalWidth":1715,"originalHeight":469}},{"name":"4733","type":1,"text":"The class confidence score for each prediction box is computed as:","markups":[{"type":1,"start":4,"end":27}]},{"name":"d818","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*qVL77IZyEnra4DvENayXUA.png","originalWidth":1528,"originalHeight":90}},{"name":"7161","type":1,"text":"It measures the confidence on both the classification and the localization (where an object is located).","markups":[{"type":1,"start":62,"end":74}]},{"name":"8084","type":1,"text":"We may mix up those scoring and probability terms easily. Here are the mathematical definitions for your future reference.","markups":[]},{"name":"38d0","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*0IPktA65WxOBfP_ULQWcmw.png","originalWidth":1624,"originalHeight":566}},{"name":"5fe5","type":3,"text":"Network design","markups":[{"type":1,"start":0,"end":14}]},{"name":"c3a9","type":4,"text":"Source","markups":[{"type":3,"start":0,"end":6,"href":"https://arxiv.org/pdf/1506.02640.pdf","title":"","rel":"","anchorType":0}],"layout":3,"metadata":{"id":"1*9ER4GVUtQGVA2Y0skC9OQQ.png","originalWidth":1920,"originalHeight":806}},{"name":"91ea","type":1,"text":"YOLO has 24 convolutional layers followed by 2 fully connected layers (FC). Some convolution layers use 1 × 1 reduction layers alternatively to reduce the depth of the features maps. For the last convolution layer, it outputs a tensor with shape (7, 7, 1024). The tensor is then flattened. Using 2 fully connected layers as a form of linear regression, it outputs 7×7×30 parameters and then reshapes to (7, 7, 30), i.e. 2 boundary box predictions per location.","markups":[]},{"name":"6672","type":1,"text":"A faster but less accurate version of YOLO, called Fast YOLO, uses only 9 convolutional layers with shallower feature maps.","markups":[]},{"name":"7bde","type":3,"text":"Loss function","markups":[{"type":1,"start":0,"end":13}]},{"name":"5db5","type":1,"text":"YOLO predicts multiple bounding boxes per grid cell. To compute the loss for the true positive, we only want one of them to be responsible for the object. For this purpose, we select the one with the highest IoU (intersection over union) with the ground truth. This strategy leads to specialization among the bounding box predictions. Each prediction gets better at predicting certain sizes and aspect ratios.","markups":[{"type":1,"start":127,"end":138}]},{"name":"8503","type":1,"text":"YOLO uses sum-squared error between the predictions and the ground truth to calculate loss. The loss function composes of:","markups":[]},{"name":"d975","type":9,"text":"the classification loss.","markups":[{"type":1,"start":4,"end":23}]},{"name":"ef04","type":9,"text":"the localization loss (errors between the predicted boundary box and the ground truth).","markups":[{"type":1,"start":4,"end":21}]},{"name":"718c","type":9,"text":"the confidence loss (the objectness of the box).","markups":[{"type":1,"start":4,"end":19}]},{"name":"b1d2","type":1,"text":"Classification loss","markups":[{"type":1,"start":0,"end":19}]},{"name":"4291","type":1,"text":"If an object is detected, the classification loss at each cell is the squared error of the class conditional probabilities for each class:","markups":[{"type":2,"start":3,"end":24}]},{"name":"b3b1","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*lF6SCAVj5jMwLxs39SCogw.png","originalWidth":1454,"originalHeight":434}},{"name":"7476","type":1,"text":"Localization loss","markups":[{"type":1,"start":0,"end":17}]},{"name":"e7fa","type":1,"text":"The localization loss measures the errors in the predicted boundary box locations and sizes. We only count the box responsible for detecting the object.","markups":[]},{"name":"3877","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*BwhGMvffFfqtND9413oiwA.png","originalWidth":1598,"originalHeight":610}},{"name":"890d","type":1,"text":"We do not want to weight absolute errors in large boxes and small boxes equally. i.e. a 2-pixel error in a large box is the same for a small box. To partially address this, YOLO predicts the square root of the bounding box width and height instead of the width and height. In addition, to put more emphasis on the boundary box accuracy, we multiply the loss by λcoord (default: 5).","markups":[{"type":2,"start":362,"end":367}]},{"name":"34aa","type":1,"text":"Confidence loss","markups":[{"type":1,"start":0,"end":15}]},{"name":"d347","type":1,"text":"If an object is detected in the box, the confidence loss (measuring the objectness of the box) is:","markups":[{"type":2,"start":3,"end":35}]},{"name":"1563","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*QT7mwEbyLJYIxTYtOWClFQ.png","originalWidth":1658,"originalHeight":464}},{"name":"6918","type":1,"text":"If an object is not detected in the box, the confidence loss is:","markups":[{"type":2,"start":3,"end":39}]},{"name":"74ef","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*Yc_OJIXOoV2WaGQ6PqhTXA.png","originalWidth":1526,"originalHeight":550}},{"name":"ca3e","type":1,"text":"Most boxes do not contain any objects. This causes a class imbalance problem, i.e. we train the model to detect background more frequently than detecting objects. To remedy this, we weight this loss down by a factor λnoobj (default: 0.5).","markups":[{"type":2,"start":217,"end":222}]},{"name":"e037","type":1,"text":"Loss","markups":[{"type":1,"start":0,"end":4}]},{"name":"a20c","type":1,"text":"The final loss adds localization, confidence and classification losses together.","markups":[]},{"name":"08f1","type":4,"text":"Source","markups":[{"type":3,"start":0,"end":6,"href":"https://arxiv.org/pdf/1506.02640.pdf","title":"","rel":"noopener","anchorType":0}],"layout":1,"metadata":{"id":"1*aW6htqx4Q7APLrSQg2eWDw.png","originalWidth":1372,"originalHeight":640}},{"name":"7519","type":3,"text":"Inference: Non-maximal suppression","markups":[]},{"name":"9c17","type":1,"text":"YOLO can make duplicate detections for the same object. To fix this, YOLO applies non-maximal suppression to remove duplications with lower confidence. Non-maximal suppression adds 2- 3% in mAP.","markups":[]},{"name":"a146","type":1,"text":"Here is one of the possible non-maximal suppression implementation:","markups":[]},{"name":"9fab","type":10,"text":"Sort the predictions by the confidence scores.","markups":[]},{"name":"7185","type":10,"text":"Start from the top scores, ignore any current prediction if we find any previous predictions that have the same class and IoU \x3e 0.5 with the current prediction.","markups":[]},{"name":"691a","type":10,"text":"Repeat step 2 until all predictions are checked.","markups":[]},{"name":"73bf","type":3,"text":"Benefits of YOLO","markups":[{"type":1,"start":0,"end":16}]},{"name":"49ce","type":9,"text":"Fast. Good for real-time processing.","markups":[]},{"name":"0c9b","type":9,"text":"Predictions (object locations and classes) are made from one single network. Can be trained end-to-end to improve accuracy.","markups":[]},{"name":"4722","type":9,"text":"YOLO is more generalized. It outperforms other methods when generalizing from natural images to other domains like artwork.","markups":[]},{"name":"382f","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*XbOnbcZmc50hyhhTwhD5QA.png","originalWidth":2140,"originalHeight":762}},{"name":"d34b","type":9,"text":"Region proposal methods limit the classifier to the specific region. YOLO accesses to the whole image in predicting boundaries. With the additional context, YOLO demonstrates fewer false positives in background areas.","markups":[]},{"name":"fb3f","type":9,"text":"YOLO detects one object per grid cell. It enforces spatial diversity in making predictions.","markups":[]},{"name":"77ea","type":3,"text":"YOLOv2","markups":[]},{"name":"2df6","type":1,"text":"SSD is a strong competitor for YOLO which at one point demonstrates higher accuracy for real-time processing. Comparing with region based detectors, YOLO has higher localization errors and the recall (measure how good to locate all objects) is lower. YOLOv2 is the second version of the YOLO with the objective of improving the accuracy significantly while making it faster.","markups":[]},{"name":"12a7","type":3,"text":"Accuracy improvements","markups":[]},{"name":"63fc","type":1,"text":"Batch normalization","markups":[{"type":1,"start":0,"end":19}]},{"name":"34ba","type":1,"text":"Add batch normalization in convolution layers. This removes the need for dropouts and pushes mAP up 2%.","markups":[]},{"name":"f021","type":1,"text":"High-resolution classifier","markups":[{"type":1,"start":0,"end":26}]},{"name":"6a6d","type":1,"text":"The YOLO training composes of 2 phases. First, we train a classifier network like VGG16. Then we replace the fully connected layers with a convolution layer and retrain it end-to-end for the object detection. YOLO trains the classifier with 224 × 224 pictures followed by 448 × 448 pictures for the object detection. YOLOv2 starts with 224 × 224 pictures for the classifier training but then retune the classifier again with 448 × 448 pictures using much fewer epochs. This makes the detector training easier and moves mAP up by 4%.","markups":[]},{"name":"afa6","type":1,"text":"Convolutional with Anchor Boxes","markups":[{"type":1,"start":0,"end":31}]},{"name":"77f0","type":1,"text":"As indicated in the YOLO paper, the early training is susceptible to unstable gradients. Initially, YOLO makes arbitrary guesses on the boundary boxes. These guesses may work well for some objects but badly for others resulting in steep gradient changes. In early training, predictions are fighting with each other on what shapes to specialize on.","markups":[{"type":3,"start":20,"end":30,"href":"https://arxiv.org/pdf/1506.02640.pdf","title":"","rel":"noopener","anchorType":0}]},{"name":"5762","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*7iwTsezrn-tSndx96twprA.jpeg","originalWidth":691,"originalHeight":498}},{"name":"4704","type":1,"text":"In the real-life domain, the boundary boxes are not arbitrary. Cars have very similar shapes and pedestrians have an approximate aspect ratio of 0.41.","markups":[]},{"name":"c23c","type":4,"text":"Source","markups":[{"type":3,"start":0,"end":6,"href":"https://www.youtube.com/watch?v=xVwsr9p3irA","title":"","rel":"noopener","anchorType":0}],"layout":1,"metadata":{"id":"1*krGqonOLMzSE_PWqH_LvQA.jpeg","originalWidth":2688,"originalHeight":1428}},{"name":"4c68","type":1,"text":"Since we only need one guess to be right, the initial training will be more stable if we start with diverse guesses that are common for real-life objects.","markups":[]},{"name":"763e","type":4,"text":"More diverse predictions","markups":[],"layout":1,"metadata":{"id":"1*CGWTPTY0sfvQoxsS0X6VFg.jpeg","originalWidth":691,"originalHeight":498}},{"name":"3040","type":1,"text":"For example, we can create 5 anchor boxes with the following shapes.","markups":[{"type":1,"start":29,"end":35}]},{"name":"db1e","type":4,"text":"5 anchor boxes","markups":[],"layout":1,"metadata":{"id":"1*8Q8r9ixjTiKLi1mrF36xCw.jpeg","originalWidth":504,"originalHeight":227}},{"name":"8507","type":1,"text":"Instead of predicting 5 arbitrary boundary boxes, we predict offsets to each of the anchor boxes above. If we constrain the offset values, we can maintain the diversity of the predictions and have each prediction focuses on a specific shape. So the initial training will be more stable.","markups":[{"type":1,"start":110,"end":119}]},{"name":"2366","type":6,"text":"In the paper, anchors are also called priors.","markups":[{"type":1,"start":38,"end":44}]},{"name":"4b0b","type":1,"text":"Here are the changes we make to the network:","markups":[]},{"name":"dd5b","type":9,"text":"Remove the fully connected layers responsible for predicting the boundary box.","markups":[]},{"name":"12f2","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*tavjieD0Bum_uX-svYUTKA.jpeg","originalWidth":1904,"originalHeight":806}},{"name":"4874","type":9,"text":"We move the class prediction from the cell level to the boundary box level. Now, each prediction includes 4 parameters for the boundary box, 1 box confidence score (objectness) and 20 class probabilities. i.e. 5 boundary boxes with 25 parameters: 125 parameters per grid cell. Same as YOLO, the objectness prediction still predicts the IOU of the ground truth and the proposed box.","markups":[]},{"name":"7c2e","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*UsqjfoW3sLkmyXKQ0Hyo8A.png","originalWidth":1047,"originalHeight":476}},{"name":"0298","type":9,"text":"To generate predictions with a shape of 7 × 7 × 125, we replace the last convolution layer with three 3 × 3 convolutional layers each outputting 1024 output channels. Then we apply a final 1 × 1 convolutional layer to convert the 7 × 7 × 1024 output into 7 × 7 × 125. (See the section on DarkNet for the details.)","markups":[]},{"name":"b734","type":4,"text":"Using convolution filters to make predictions.","markups":[],"layout":1,"metadata":{"id":"1*KiSd2CBfcs5af6oliHCqzw.jpeg","originalWidth":1579,"originalHeight":943}},{"name":"ef2c","type":9,"text":"Change the input image size from 448 × 448 to 416 × 416. This creates an odd number spatial dimension (7×7 v.s. 8×8 grid cell). The center of a picture is often occupied by a large object. With an odd number grid cell, it is more certain on where the object belongs.","markups":[]},{"name":"a764","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*89qezEeLKJLpD8_fM_H4qQ.jpeg","originalWidth":822,"originalHeight":379}},{"name":"7155","type":9,"text":"Remove one pooling layer to make the spatial output of the network to 13×13 (instead of 7×7).","markups":[{"type":1,"start":70,"end":76}]},{"name":"9de4","type":1,"text":"Anchor boxes decrease mAP slightly from 69.5 to 69.2 but the recall improves from 81% to 88%. i.e. even the accuracy is slightly decreased but it increases the chances of detecting all the ground truth objects.","markups":[]},{"name":"6c07","type":1,"text":"Dimension Clusters","markups":[{"type":1,"start":0,"end":18}]},{"name":"ea00","type":1,"text":"In many problem domains, the boundary boxes have strong patterns. For example, in the autonomous driving, the 2 most common boundary boxes will be cars and pedestrians at different distances. To identify the top-K boundary boxes that have the best coverage for the training data, we run K-means clustering on the training data to locate the centroids of the top-K clusters.","markups":[]},{"name":"d8a6","type":4,"text":"(Image modified form a k-means cluster)","markups":[{"type":3,"start":21,"end":38,"href":"https://mapr.com/blog/monitoring-real-time-uber-data-using-spark-machine-learning-streaming-and-kafka-api-part-1/","title":"","rel":"noopener","anchorType":0}],"layout":1,"metadata":{"id":"1*esSmI0UaMr-GrqkUGMg0hA.jpeg","originalWidth":388,"originalHeight":298}},{"name":"0b47","type":1,"text":"Since we are dealing with boundary boxes rather than points, we cannot use the regular spatial distance to measure datapoint distances. No surprise, we use IoU.","markups":[]},{"name":"b048","type":4,"text":"Source","markups":[{"type":3,"start":0,"end":6,"href":"https://arxiv.org/pdf/1612.08242.pdf","title":"","rel":"","anchorType":0}],"layout":1,"metadata":{"id":"1*l5wvrPjLlFp6Whgy0MqbKQ.png","originalWidth":1114,"originalHeight":590}},{"name":"a0d7","type":1,"text":"On the left, we plot the average IoU between the anchors and the ground truth boxes using different numbers of clusters (anchors). As the number of anchors increases, the accuracy improvement plateaus. For the best return, YOLO settles down with 5 anchors. On the right, it displays the 5 anchors’ shapes. The purplish-blue rectangles are selected from the COCO dataset while the black border rectangles are selected from the VOC2007. In both cases, we have more thin and tall anchors indicating that real-life boundary boxes are not arbitrary.","markups":[]},{"name":"ae5e","type":6,"text":"Unless we are comparing YOLO and YOLOv2, we will reference YOLOv2 as YOLO for now.","markups":[]},{"name":"0780","type":1,"text":"Direct location prediction","markups":[{"type":1,"start":0,"end":26}]},{"name":"d58d","type":1,"text":"We make predictions on the offsets to the anchors. Nevertheless, if it is unconstrained, our guesses will be randomized again. YOLO predicts 5 parameters (tx, ty, tw, th, and to) and applies the sigma function to constraint its possible offset range.","markups":[{"type":2,"start":156,"end":157},{"type":2,"start":160,"end":161},{"type":2,"start":164,"end":165},{"type":2,"start":168,"end":169},{"type":2,"start":176,"end":177}]},{"name":"06b8","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*38-Tdx-wQA7c3TX5hdnwpw.jpeg","originalWidth":1536,"originalHeight":1020}},{"name":"60ab","type":1,"text":"Here is the visualization. The blue box below is the predicted boundary box and the dotted rectangle is the anchor.","markups":[]},{"name":"7034","type":4,"text":"Modified from the paper.","markups":[{"type":3,"start":18,"end":23,"href":"https://arxiv.org/pdf/1612.08242.pdf","title":"","rel":"","anchorType":0}],"layout":1,"metadata":{"id":"1*gyOSRA_FDz4Pf5njoUb4KQ.jpeg","originalWidth":1214,"originalHeight":918}},{"name":"91a9","type":1,"text":"With the use of k-means clustering (dimension clusters) and the improvement mentioned in this section, mAP increases 5%.","markups":[]},{"name":"5583","type":1,"text":"Fine-Grained Features","markups":[{"type":1,"start":0,"end":21}]},{"name":"2313","type":1,"text":"Convolution layers decrease the spatial dimension gradually. As the corresponding resolution decreases, it is harder to detect small objects. Other object detectors like SSD locate objects from different layers of feature maps. So each layer specializes at a different scale. YOLO adopts a different approach called passthrough. It reshapes the 28 × 28 × 512 layer to 14 × 14 × 2048. Then it concatenates with the original 14 × 14 ×1024 output layer. Now we apply convolution filters on the new 14 × 14 × 3072 layer to make predictions.","markups":[]},{"name":"aa05","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*3fLdTcbKEeeQAt4mt9LnFQ.jpeg","originalWidth":1696,"originalHeight":366}},{"name":"32a7","type":1,"text":"Multi-Scale Training","markups":[{"type":1,"start":0,"end":20}]},{"name":"3c3d","type":1,"text":"After removing the fully connected layers, YOLO can take images of different sizes. If the width and height are doubled, we are just making 4x output grid cells and therefore 4x predictions. Since the YOLO network downsamples the input by 32, we just need to make sure the width and height is a multiple of 32. During training, YOLO takes images of size 320×320, 352×352, … and 608×608 (with a step of 32). For every 10 batches, YOLOv2 randomly selects another image size to train the model. This acts as data augmentation and forces the network to predict well for different input image dimension and scale. In additional, we can use lower resolution images for object detection at the cost of accuracy. This can be a good tradeoff for speed on low GPU power devices. At 288 × 288 YOLO runs at more than 90 FPS with mAP almost as good as Fast R-CNN. At high-resolution YOLO achieves 78.6 mAP on VOC 2007.","markups":[]},{"name":"8d9e","type":3,"text":"Accuracy","markups":[{"type":1,"start":0,"end":8}]},{"name":"97e0","type":1,"text":"Here is the accuracy improvements after applying the techniques discussed so far:","markups":[]},{"name":"d6c3","type":4,"text":"Source","markups":[{"type":3,"start":0,"end":6,"href":"https://arxiv.org/pdf/1612.08242.pdf","title":"","rel":"noopener","anchorType":0}],"layout":1,"metadata":{"id":"1*3IdCKSzR5R0lIE1LSmN4Bg.png","originalWidth":1568,"originalHeight":648}},{"name":"1739","type":1,"text":"Accuracy comparison for different detectors:","markups":[]},{"name":"5ec1","type":4,"text":"Source","markups":[{"type":3,"start":0,"end":6,"href":"https://arxiv.org/pdf/1612.08242.pdf","title":"","rel":"noopener","anchorType":0}],"layout":1,"metadata":{"id":"1*NJj17Z6FgffYaA4WH2WIjw.png","originalWidth":462,"originalHeight":325}},{"name":"0d9a","type":3,"text":"Speed improvement","markups":[]},{"name":"89bb","type":1,"text":"GoogLeNet","markups":[{"type":1,"start":0,"end":9}]},{"name":"34c3","type":1,"text":"VGG16 requires 30.69 billion floating point operations for a single pass over a 224 × 224 image versus 8.52 billion operations for a customized GoogLeNet. We can replace the VGG16 with the customized GoogLeNet. However, YOLO pays a price on the top-5 accuracy for ImageNet: accuracy drops from 90.0% to 88.0%.","markups":[]},{"name":"4eea","type":1,"text":"DarkNet","markups":[{"type":1,"start":0,"end":7}]},{"name":"e314","type":1,"text":"We can further simplify the backbone CNN used. Darknet requires 5.58 billion operations only. With DarkNet, YOLO achieves 72.9% top-1 accuracy and 91.2% top-5 accuracy on ImageNet. Darknet uses mostly 3 × 3 filters to extract features and 1 × 1 filters to reduce output channels. It also uses global average pooling to make predictions. Here is the detail network description:","markups":[]},{"name":"3e5c","type":4,"text":"Modified from source","markups":[{"type":3,"start":14,"end":20,"href":"https://arxiv.org/pdf/1612.08242.pdf","title":"","rel":"noopener","anchorType":0}],"layout":1,"metadata":{"id":"1*8FiQUakp9i4MneU4VXk4Ww.png","originalWidth":464,"originalHeight":598}},{"name":"d0d9","type":1,"text":"We replace the last convolution layer (the cross-out section) with three 3 × 3 convolutional layers each outputting 1024 output channels. Then we apply a final 1 × 1 convolutional layer to convert the 7 × 7 × 1024 output into 7 × 7 × 125. (5 boundary boxes each with 4 parameters for the box, 1 objectness score and 20 conditional class probabilities)","markups":[]},{"name":"970d","type":4,"text":"YOLO with DarkNet","markups":[],"layout":3,"metadata":{"id":"1*NBnDpz8fitkhcdnkgF2bvg.png","originalWidth":1794,"originalHeight":211}},{"name":"7726","type":3,"text":"Training","markups":[]},{"name":"9a43","type":1,"text":"YOLO is trained with the ImageNet 1000 class classification dataset in 160 epochs: using stochastic gradient descent with a starting learning rate of 0.1, polynomial rate decay with a power of 4, weight decay of 0.0005 and momentum of 0.9. In the initial training, YOLO uses 224 × 224 images, and then retune it with 448× 448 images for 10 epochs at a 10−3 learning rate. After the training, the classifier achieves a top-1 accuracy of 76.5% and a top-5 accuracy of 93.3%.","markups":[]},{"name":"406c","type":1,"text":"Then the fully connected layers and the last convolution layer is removed for a detector. YOLO adds three 3 × 3 convolutional layers with 1024 filters each followed by a final 1 × 1 convolutional layer with 125 output channels. (5 box predictions each with 25 parameters) YOLO also add a passthrough layer. YOLO trains the network for 160 epochs with a starting learning rate of 10−3 , dividing it by 10 at 60 and 90 epochs. YOLO uses a weight decay of 0.0005 and momentum of 0.9.","markups":[]},{"name":"c14b","type":3,"text":"Classification","markups":[{"type":1,"start":0,"end":14}]},{"name":"9aa2","type":1,"text":"Datasets for object detection have far fewer class categories than those for classification. To expand the classes that YOLO can detect, YOLO proposes a method to mix images from both detection and classification datasets during training. It trains the end-to-end network with the object detection samples while backpropagates the classification loss from the classification samples to train the classifier path. This approach encounters a few challenges:","markups":[]},{"name":"a98e","type":9,"text":"How do we merge class labels from different datasets? In particular, object detection datasets and different classification datasets uses different labels.","markups":[]},{"name":"0d6b","type":9,"text":"Any merged labels may not be mutually exclusive, for example, Norfolk terrier in ImageNet and dog in COCO. Since it is not mutually exclusive, we can not use softmax to compute the probability.","markups":[{"type":2,"start":62,"end":77},{"type":2,"start":94,"end":98}]},{"name":"ed9e","type":1,"text":"Hierarchical classification","markups":[{"type":1,"start":0,"end":27}]},{"name":"92f9","type":1,"text":"Without going into details, YOLO combines labels in different datasets to form a tree-like structure WordTree. The children form an is-a relationship with its parent like biplane is a plane. But the merged labels are now not mutually exclusive.","markups":[{"type":1,"start":101,"end":109}]},{"name":"3704","type":4,"text":"Combining COCO and ImageNet labels to a hierarchical WordTree (source)","markups":[{"type":3,"start":63,"end":69,"href":"https://arxiv.org/pdf/1612.08242.pdf","title":"","rel":"noopener","anchorType":0}],"layout":1,"metadata":{"id":"1*QKwSclDLcT8eJxyj3CVL0w.png","originalWidth":1440,"originalHeight":1482}},{"name":"3bec","type":1,"text":"Let’s simplify the discussion using the 1000 class ImageNet. Instead of predicting 1000 labels in a flat structure, we create the corresponding WordTree which has 1000 leave nodes for the original labels and 369 nodes for their parent classes. Originally, YOLO predicts the class score for the biplane. But with the WordTree, it now predicts the score for the biplane given it is an airplane.","markups":[]},{"name":"e2b5","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*TALo1-LuWbF80RTCM7bszw.png","originalWidth":1562,"originalHeight":60}},{"name":"2381","type":1,"text":"Since","markups":[]},{"name":"e1bf","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*0Oyd6FWXo7OJzzuXuXSoDQ.png","originalWidth":1554,"originalHeight":90}},{"name":"132d","type":1,"text":"we can apply a softmax function to compute the probability","markups":[]},{"name":"4a97","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*_gX42bmgvyib4lyR9GQrAg.png","originalWidth":1576,"originalHeight":70}},{"name":"83de","type":1,"text":"from the scores of its own and the siblings. The difference is, instead of one softmax operations, YOLO performs multiple softmax operations for each parent’s children.","markups":[]},{"name":"7b7d","type":4,"text":"source","markups":[{"type":3,"start":0,"end":6,"href":"https://arxiv.org/pdf/1612.08242.pdf","title":"","rel":"noopener","anchorType":0}],"layout":1,"metadata":{"id":"1*_0ijX5oRZdQCNlSk-gXj3Q.jpeg","originalWidth":386,"originalHeight":329}},{"name":"c923","type":1,"text":"The class probability is then computed from the YOLO predictions by going up the WordTree.","markups":[]},{"name":"0e48","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*0XHKAh0GxpW22y1DlL4hYA.png","originalWidth":1578,"originalHeight":238}},{"name":"bc6c","type":1,"text":"For classification, we assume an object is already detected and therefore Pr(physical object)=1.","markups":[]},{"name":"5c22","type":1,"text":"One benefit of the hierarchy classification is that when YOLO cannot distinguish the type of airplane, it gives a high score to the airplane instead of forcing it into one of the sub-categories.","markups":[]},{"name":"b4cc","type":1,"text":"When YOLO sees a classification image, it only backpropagates classification loss to train the classifier. YOLO finds the bounding box that predicts the highest probability for that class and it computes the classification loss as well as those from the parents. (If an object is labeled as a biplane, it is also considered to be labeled as airplane, air, vehicle… ) This encourages the model to extract features common to them. So even we have never trained a specific class of objects for object detection, we can still make such predictions by generalizing predictions from related objects.","markups":[]},{"name":"0011","type":1,"text":"In object detection, we set Pr(physical object) equals to the box confidence score which measures whether the box has an object. YOLO traverses down the tree, taking the highest confidence path at every split until it reaches some threshold and YOLO predicts that object class.","markups":[]},{"name":"9465","type":1,"text":"YOLO9000","markups":[{"type":1,"start":0,"end":8}]},{"name":"c79d","type":1,"text":"YOLO9000 extends YOLO to detect objects over 9000 classes using hierarchical classification with a 9418 node WordTree. It combines samples from COCO and the top 9000 classes from the ImageNet. YOLO samples four ImageNet data for every COCO data. It learns to find objects using the detection data in COCO and to classify these objects with ImageNet samples.","markups":[]},{"name":"4b01","type":1,"text":"During the evaluation, YOLO test images on categories that it knows how to classify but not trained directly to locate them, i.e. categories that do not exist in COCO. YOLO9000 evaluates its result from the ImageNet object detection dataset which has 200 categories. It shares about 44 categories with COCO. Therefore, the dataset contains 156 categories that have never been trained directly on how to locate them. YOLO extracts similar features for related object types. Hence, we can detect those 156 categories by simply from the feature values.","markups":[]},{"name":"69d2","type":1,"text":"YOLO9000 gets 19.7 mAP overall with 16.0 mAP on those 156 categories. YOLO9000 performs well with new species of animals not found in COCO because their shapes can be generalized easily from their parent classes. However, COCO does not have bounding box labels for any type of clothing so the test struggles with categories like “sunglasses”.","markups":[]},{"name":"b8ad","type":3,"text":"YOLOv3","markups":[]},{"name":"fd5c","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"28431402a61e5d8c00d4e6827e656b8b","iframeWidth":854,"iframeHeight":480,"thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Fi.ytimg.com%2Fvi%2FMPU2HistivI%2Fhqdefault.jpg&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"9fad","type":1,"text":"A quote from the YOLO web site on YOLOv3:","markups":[]},{"name":"974f","type":6,"text":"On a Pascal Titan X it processes images at 30 FPS and has a mAP of 57.9% on COCO test-dev.","markups":[]},{"name":"667f","type":1,"text":"Class Prediction","markups":[{"type":1,"start":0,"end":16}]},{"name":"7f2d","type":1,"text":"Most classifiers assume output labels are mutually exclusive. It is true if the output are mutually exclusive object classes. Therefore, YOLO applies a softmax function to convert scores into probabilities that sum up to one. YOLOv3 uses multi-label classification. For example, the output labels may be “pedestrian” and “child” which are not non-exclusive. (the sum of output can be greater than 1 now.) YOLOv3 replaces the softmax function with independent logistic classifiers to calculate the likeliness of the input belongs to a specific label. Instead of using mean square error in calculating the classification loss, YOLOv3 uses binary cross-entropy loss for each label. This also reduces the computation complexity by avoiding the softmax function.","markups":[]},{"name":"c898","type":1,"text":"Bounding box prediction & cost function calculation","markups":[{"type":1,"start":0,"end":51}]},{"name":"373a","type":1,"text":"YOLOv3 predicts an objectness score for each bounding box using logistic regression. YOLOv3 changes the way in calculating the cost function. If the bounding box prior (anchor) overlaps a ground truth object more than others, the corresponding objectness score should be 1. For other priors with overlap greater than a predefined threshold (default 0.5), they incur no cost. Each ground truth object is associated with one boundary box prior only. If a bounding box prior is not assigned, it incurs no classification and localization lost, just confidence loss on objectness. We use tx and ty (instead of bx and by) to compute the loss.","markups":[]},{"name":"a75a","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*UuIx6sH39tefFMxgWAaaNQ.png","originalWidth":1040,"originalHeight":180}},{"name":"6b02","type":1,"text":"Feature Pyramid Networks (FPN) like Feature Pyramid","markups":[{"type":1,"start":0,"end":51}]},{"name":"b55f","type":1,"text":"YOLOv3 makes 3 predictions per location. Each prediction composes of a boundary box, a objectness and 80 class scores, i.e. N × N × [3 × (4 + 1 + 80) ] predictions.","markups":[]},{"name":"c2ae","type":1,"text":"YOLOv3 makes predictions at 3 different scales (similar to the FPN):","markups":[]},{"name":"403a","type":10,"text":"In the last feature map layer.","markups":[]},{"name":"6ecf","type":10,"text":"Then it goes back 2 layers back and upsamples it by 2. YOLOv3 then takes a feature map with higher resolution and merge it with the upsampled feature map using element-wise addition. YOLOv3 apply convolutional filters on the merged map to make the second set of predictions.","markups":[]},{"name":"7b3e","type":10,"text":"Repeat 2 again so the resulted feature map layer has good high-level structure (semantic) information and good resolution spatial information on object locations.","markups":[]},{"name":"ecae","type":1,"text":"To determine the priors, YOLOv3 applies k-means cluster. Then it pre-select 9 clusters. For COCO, the width and height of the anchors are (10×13),(16×30),(33×23),(30×61),(62×45),(59× 119),(116 × 90),(156 × 198),(373 × 326). These 9 priors are grouped into 3 different groups according to their scale. Each group is assigned to a specific feature map above in detecting objects.","markups":[]},{"name":"4161","type":1,"text":"Feature extractor","markups":[{"type":1,"start":0,"end":17}]},{"name":"f03d","type":1,"text":"A new 53-layer Darknet-53 is used to replace the Darknet-19 as the feature extractor. Darknet-53 mainly compose of 3 × 3 and 1× 1 filters with skip connections like the residual network in ResNet. Darknet-53 has less BFLOP (billion floating point operations) than ResNet-152, but achieves the same classification accuracy at 2x faster.","markups":[]},{"name":"9603","type":4,"text":"Darknet-53","markups":[{"type":3,"start":0,"end":10,"href":"https://pjreddie.com/media/files/papers/YOLOv3.pdf","title":"","rel":"","anchorType":0}],"layout":1,"metadata":{"id":"1*biRYJyCSv-UTbTQTa4Afqg.png","originalWidth":334,"originalHeight":462}},{"name":"def0","type":1,"text":"YOLOv3 performance","markups":[{"type":1,"start":0,"end":18}]},{"name":"20af","type":1,"text":"YOLOv3's COCO AP metric is on par with SSD but 3x faster. But YOLOv3’s AP is still behind RetinaNet. In particular, AP@IoU=.75 drops significantly comparing with RetinaNet which suggests YOLOv3 has higher localization error. YOLOv3 also shows significant improvement in detecting small objects.","markups":[]},{"name":"5cda","type":4,"text":"","markups":[],"layout":3,"metadata":{"id":"1*bFMwN__ZgfvVRYuo4o8EEg.png","originalWidth":1028,"originalHeight":290}},{"name":"148d","type":1,"text":"YOLOv3 performs very well in the fast detector category when speed is important.","markups":[]},{"name":"27e3","type":4,"text":"Source","markups":[{"type":3,"start":0,"end":6,"href":"https://pjreddie.com/media/files/papers/YOLOv3.pdf","title":"","rel":"noopener","anchorType":0}],"layout":1,"metadata":{"id":"1*RFpjH8D6TStBaYuZYehe_g.png","originalWidth":1328,"originalHeight":828}},{"name":"3054","type":3,"text":"Resources","markups":[]},{"name":"e094","type":1,"text":"The original paper on YOLO.","markups":[{"type":3,"start":0,"end":27,"href":"https://arxiv.org/pdf/1506.02640.pdf","title":"","rel":"noopener","anchorType":0}]},{"name":"7b35","type":1,"text":"Paper on YOLOv2 and YOLO9000.","markups":[{"type":3,"start":0,"end":29,"href":"https://arxiv.org/pdf/1612.08242.pdf","title":"","rel":"","anchorType":0}]},{"name":"fac5","type":1,"text":"DarkNet implementation.","markups":[{"type":3,"start":0,"end":23,"href":"https://github.com/pjreddie/darknet","title":"","rel":"noopener","anchorType":0}]}],"sections":[{"name":"b001","startIndex":0}]},"postDisplay":{"coverless":true}},"virtuals":{"allowNotes":true,"previewImage":{"imageId":"1*j4PnWfxP3yoVPOFyI27tww.jpeg","filter":"","backgroundSize":"","originalWidth":3036,"originalHeight":1855,"strategy":"resample","height":0,"width":0},"wordCount":3903,"imageCount":45,"readingTime":17.72830188679245,"subtitle":"You only look once (YOLO) is an object detection system targeted for real-time processing. We will introduce YOLO, YOLOv2 and YOLO9000 in…","userPostRelation":{"userId":"381bf2a1ecff","postId":"28b1b93e2088","readAt":1553019978920,"readLaterAddedAt":0,"votedAt":0,"collaboratorAddedAt":0,"notesAddedAt":0,"subscribedAt":0,"lastReadSectionName":"b001","lastReadVersionId":"41f9c394b60f","lastReadAt":1553020024272,"lastReadParagraphName":"65e3","lastReadPercentage":0.06,"viewedAt":1553019433800,"presentedCountInResponseManagement":0,"clapCount":0,"seriesUpdateNotifsOptedInAt":0,"queuedAt":0,"seriesFirstViewedAt":0,"presentedCountInStream":0,"seriesLastViewedAt":0,"audioProgressSec":0},"usersBySocialRecommends":[{"userId":"33eb7bedce13","name":"Park Chansung","username":"parkchansung","createdAt":1484535666325,"imageId":"1*s2i0_vQGhBc8TKtNd3Svaw.jpeg","backgroundImageId":"","bio":"Software Developer eagering to become Data Scientist someday","twitterScreenName":"","facebookAccountId":"10208563442788902","allowNotes":1,"mediumMemberAt":0,"isNsfw":false,"isWriterProgramEnrolled":true,"isQuarantined":false,"type":"User"}],"noIndex":false,"recommends":609,"socialRecommends":[{"user":{"userId":"33eb7bedce13","name":"Park Chansung","username":"parkchansung","createdAt":1484535666325,"imageId":"1*s2i0_vQGhBc8TKtNd3Svaw.jpeg","backgroundImageId":"","bio":"Software Developer eagering to become Data Scientist someday","twitterScreenName":"","facebookAccountId":"10208563442788902","allowNotes":1,"mediumMemberAt":0,"isNsfw":false,"isWriterProgramEnrolled":true,"isQuarantined":false,"type":"User"}}],"isBookmarked":false,"tags":[{"slug":"machine-learning","name":"Machine Learning","postCount":65204,"metadata":{"postCount":65204,"coverImage":{"id":"1*EzG5lSdofG6lR66VSXlMjg.png","originalWidth":700,"originalHeight":455,"isFeatured":true}},"type":"Tag"},{"slug":"deep-learning","name":"Deep Learning","postCount":16115,"metadata":{"postCount":16115,"coverImage":{"id":"1*n_VyEa-KbM8yfEooR8nxwQ.png","originalWidth":756,"originalHeight":353,"isFeatured":true}},"type":"Tag"},{"slug":"computer-vision","name":"Computer Vision","postCount":3183,"metadata":{"postCount":3183,"coverImage":{"id":"1*GogtbLacrgLAvlHkUz3cnA.png","originalWidth":1200,"originalHeight":200,"isFeatured":true}},"type":"Tag"},{"slug":"artificial-intelligence","name":"Artificial Intelligence","postCount":78666,"metadata":{"postCount":78666,"coverImage":{"id":"1*gAn_BSffVBcwCIR6bDgK1g.jpeg"}},"type":"Tag"}],"socialRecommendsCount":1,"responsesCreatedCount":48,"links":{"entries":[{"url":"https://mapr.com/blog/monitoring-real-time-uber-data-using-spark-machine-learning-streaming-and-kafka-api-part-1/","alts":[],"httpStatus":200},{"url":"https://medium.com/@jonathan_hui/real-time-object-detection-with-yolo-yolov2-28b1b93e2088#b8ad","alts":[{"type":2,"url":"medium://p/28b1b93e2088"},{"type":3,"url":"medium://p/28b1b93e2088"}],"httpStatus":200},{"url":"https://pjreddie.com/darknet/yolo/","alts":[],"httpStatus":200},{"url":"https://www.youtube.com/watch?v=xVwsr9p3irA","alts":[{"type":2,"url":"vnd.youtube://www.youtube.com/watch?v=xVwsr9p3irA&feature=applinks"},{"type":3,"url":"vnd.youtube://www.youtube.com/watch?v=xVwsr9p3irA&feature=applinks"}],"httpStatus":200},{"url":"https://github.com/pjreddie/darknet","alts":[],"httpStatus":200},{"url":"https://pjreddie.com/media/files/papers/YOLOv3.pdf","alts":[],"httpStatus":200},{"url":"https://arxiv.org/pdf/1612.08242.pdf","alts":[],"httpStatus":200},{"url":"https://arxiv.org/pdf/1506.02640.pdf","alts":[],"httpStatus":0}],"version":"0.3","generatedAt":1553719288350},"isLockedPreviewOnly":false,"takeoverId":"","metaDescription":"","totalClapCount":4289,"sectionCount":1,"readingList":0,"topics":[]},"coverless":true,"slug":"real-time-object-detection-with-yolo-yolov2","translationSourcePostId":"","translationSourceCreatorId":"","isApprovedTranslation":false,"inResponseToPostId":"","inResponseToRemovedAt":0,"isTitleSynthesized":true,"allowResponses":true,"importedUrl":"","importedPublishedAt":0,"visibility":0,"uniqueSlug":"real-time-object-detection-with-yolo-yolov2-28b1b93e2088","previewContent":{"bodyModel":{"paragraphs":[{"name":"previewImage","type":4,"text":"","layout":10,"metadata":{"id":"1*j4PnWfxP3yoVPOFyI27tww.jpeg","originalWidth":3036,"originalHeight":1855,"isFeatured":true}},{"name":"79c8","type":3,"text":"Real-time Object Detection with YOLO, YOLOv2 and now YOLOv3","markups":[],"alignment":1}],"sections":[{"startIndex":0}]},"isFullContent":false,"subtitle":"You only look once (YOLO) is an object detection system targeted for real-time processing. We will introduce YOLO, YOLOv2 and YOLO9000 in…"},"license":0,"inResponseToMediaResourceId":"","canonicalUrl":"https://medium.com/@jonathan_hui/real-time-object-detection-with-yolo-yolov2-28b1b93e2088","approvedHomeCollectionId":"","newsletterId":"","webCanonicalUrl":"https://medium.com/@jonathan_hui/real-time-object-detection-with-yolo-yolov2-28b1b93e2088","mediumUrl":"https://medium.com/@jonathan_hui/real-time-object-detection-with-yolo-yolov2-28b1b93e2088","migrationId":"","notifyFollowers":true,"notifyTwitter":false,"notifyFacebook":false,"responseHiddenOnParentPostAt":0,"isSeries":false,"isSubscriptionLocked":false,"seriesLastAppendedAt":0,"audioVersionDurationSec":0,"sequenceId":"","isNsfw":false,"isEligibleForRevenue":false,"isBlockedFromHightower":false,"deletedAt":0,"lockedPostSource":0,"hightowerMinimumGuaranteeStartsAt":0,"hightowerMinimumGuaranteeEndsAt":0,"featureLockRequestAcceptedAt":0,"mongerRequestType":1,"layerCake":0,"socialTitle":"","socialDek":"","editorialPreviewTitle":"","editorialPreviewDek":"","curationEligibleAt":0,"type":"Post"},"mentionedUsers":[],"collaborators":[],"collectionUserRelations":[],"mode":null,"references":{"User":{"bd51f1a63813":{"userId":"bd51f1a63813","name":"Jonathan Hui","username":"jonathan_hui","createdAt":1518417490123,"imageId":"1*c3Z3aOPBooxEX4tx4RkzLw.jpeg","backgroundImageId":"","bio":"Deep Learning","twitterScreenName":"","socialStats":{"userId":"bd51f1a63813","usersFollowedCount":16,"usersFollowedByCount":6776,"type":"SocialStats"},"social":{"userId":"381bf2a1ecff","targetUserId":"bd51f1a63813","isFollowing":true,"isTwitterFollowing":false,"isFacebookFollowing":false,"isMediumFollowing":true,"type":"Social"},"facebookAccountId":"","allowNotes":1,"mediumMemberAt":0,"isNsfw":false,"isWriterProgramEnrolled":true,"isQuarantined":false,"type":"User"}},"Social":{"bd51f1a63813":{"userId":"381bf2a1ecff","targetUserId":"bd51f1a63813","isFollowing":true,"isTwitterFollowing":false,"isFacebookFollowing":false,"isMediumFollowing":true,"type":"Social"}},"SocialStats":{"bd51f1a63813":{"userId":"bd51f1a63813","usersFollowedCount":16,"usersFollowedByCount":6776,"type":"SocialStats"}}}})
// ]]></script><script id="parsely-cfg" src="//d1z2jf7jlzjs58.cloudfront.net/keys/medium.com/p.js"></script><script type="text/javascript">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent".split(" "), 0); branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true, 'tracking_disabled':  false }, function(err, data) {});</script></body></html>